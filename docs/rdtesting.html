<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>RD Testing</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="site_libs/kePrint-0.0.1/kePrint.js"></script>

<link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">


  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html"> 
<span class="menu-text">Melle Albada</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="./rdtesting.html" aria-current="page"> 
<span class="menu-text">RD Testing</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./software.html"> 
<span class="menu-text">Software</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#replication" id="toc-replication" class="nav-link active" data-scroll-target="#replication">Replication</a></li>
  <li><a href="#tests" id="toc-tests" class="nav-link" data-scroll-target="#tests">Tests</a>
  <ul>
  <li><a href="#test-1-rd-plot-of-main-model" id="toc-test-1-rd-plot-of-main-model" class="nav-link" data-scroll-target="#test-1-rd-plot-of-main-model">Test 1: RD Plot of Main Model</a></li>
  <li><a href="#test-2-density-test" id="toc-test-2-density-test" class="nav-link" data-scroll-target="#test-2-density-test">Test 2: Density Test</a></li>
  <li><a href="#test-3-balance-test" id="toc-test-3-balance-test" class="nav-link" data-scroll-target="#test-3-balance-test">Test 3: Balance Test</a></li>
  <li><a href="#test-4-donut-rd" id="toc-test-4-donut-rd" class="nav-link" data-scroll-target="#test-4-donut-rd">Test 4: Donut RD</a></li>
  <li><a href="#test-5-bandwidth" id="toc-test-5-bandwidth" class="nav-link" data-scroll-target="#test-5-bandwidth">Test 5: Bandwidth</a></li>
  <li><a href="#test-6-polynomial" id="toc-test-6-polynomial" class="nav-link" data-scroll-target="#test-6-polynomial">Test 6: Polynomial</a></li>
  <li><a href="#test-7-kernel" id="toc-test-7-kernel" class="nav-link" data-scroll-target="#test-7-kernel">Test 7: Kernel</a></li>
  <li><a href="#test-8-placebo-cutoffs" id="toc-test-8-placebo-cutoffs" class="nav-link" data-scroll-target="#test-8-placebo-cutoffs">Test 8: Placebo Cutoffs</a></li>
  <li><a href="#test-9-statistical-power" id="toc-test-9-statistical-power" class="nav-link" data-scroll-target="#test-9-statistical-power">Test 9: Statistical Power</a></li>
  <li><a href="#test-10-covariates" id="toc-test-10-covariates" class="nav-link" data-scroll-target="#test-10-covariates">Test 10: Covariates</a></li>
  </ul></li>
  <li><a href="#summary" id="toc-summary" class="nav-link" data-scroll-target="#summary">Summary</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">RD Testing</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>This page accompanies my working paper on selective testing in regression discontinuity (RD) designs. It gives recommendations for systematically conducting tests, according to recent insights from the methodological RD literature. I focus on ten typical RD tests that cover the most important aspects of an RD analysis: the RD identification assumption, sensitivity to the model specification, and other RD-specific threats, such as low statistical power, overfitting, and excessive false positive findings. To illustrate how these tests can be conducted, I apply them to a data set from <span class="citation" data-cites="klasnja2017">Klašnja and Titiunik (<a href="#ref-klasnja2017" role="doc-biblioref">2017</a>)</span>, KT henceforth (<a href="https://www.dropbox.com/s/wykihaa4w6wm6iy/curse_replication.zip?dl=0">replication package</a>). The R and Stata code may serve as a template for other researchers that want to conduct RD tests.</p>
<p>KT explore political accountability in Brazilian mayorial elections. They argue that weak party structures and term limits undermine accountability, leading to opportunistic behavior by incumbents, which voters punish in subsequent elections. In my replication, I test the main result presented in Table 2. The statistically significant coefficient of -0.15 suggests that an incumbent party that is barely reelected is 15 percentage points less likely to win the following election than a similar incumbent party that is barely defeated. Table 2 thus demonstrates the existence of an incumbency disadvantage, which the authors link to weak party structures and term limits in the rest of the paper.</p>
<p>As their main model specification, KT use a local linear model with an MSE-optimal bandwidth, triangular kernel, and no covariates. Inference is conducted using robust confidence intervals. These are the default settings I recommend in the working paper. To estimate RD models, both KT and I rely on <code>rdrobust</code> software. It provides a convenient way to apply polynomial estimators, allowing me to conduct many of the tests by adding or changing a single argument/option.</p>
<section id="replication" class="level3">
<h3 class="anchored" data-anchor-id="replication">Replication</h3>
<p>Before replicating the result for incumbent parties in Table 2 and subjecting it to various tests, I first have to set up R and Stata. This consists of loading the necessary packages/commands, reading the data, and scaling some of the covariates for ease of interpretation. The most notable line of R code, the one that uses the devtools function, loads the functions required for Hartman’s <span class="citation" data-cites="hartman2021">(<a href="#ref-hartman2021" role="doc-biblioref">2021</a>)</span> equivalence tests. There is currently no Stata version available.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">Stata</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(haven) <span class="co"># version 2.5.3</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr) <span class="co"># version 1.1.2</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rdrobust) <span class="co"># version 2.1.1</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(magrittr) <span class="co"># version 2.0.3</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rdpower) <span class="co"># version 2.2</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rddensity) <span class="co"># version 2.6</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra) <span class="co"># version 2.3</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2) <span class="co"># version 3.4.2</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra) <span class="co"># version 1.3.4</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(devtools) <span class="co"># version 2.4.5</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">source_url</span>(<span class="st">"https://github.com/ekhartman/rdd_equivalence/blob/master/RDD_equivalence_functions.R?raw=TRUE"</span>)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read_dta</span>(<span class="st">"E:/RDData/APSR/Klasnja/KlasnjaTitiunik-Brazil-data.dta"</span>)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&lt;&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(mv_incparty)) </span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&lt;&gt;%</span> <span class="fu">mutate</span>(<span class="at">population=</span>population<span class="sc">/</span><span class="dv">1000</span>,</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>               <span class="at">expend_total=</span>expend_total<span class="sc">/</span><span class="dv">1000</span>,</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>               <span class="at">revenue_total=</span>revenue_total<span class="sc">/</span><span class="dv">1000</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co">/* net install rdrobust, from(https://raw.githubusercontent.com/rdpackages/rdrobust/master/stata) replace</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="co">net install rddensity, from(https://raw.githubusercontent.com/rdpackages/rddensity/master/stata) replace</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co">net install lpdensity, from(https://raw.githubusercontent.com/nppackages/lpdensity/master/stata) replace</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co">net install rdpower, from(https://raw.githubusercontent.com/rdpackages/rdpower/master/stata) replace */</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="kw">use</span> <span class="st">"E:/RDData/APSR/Klasnja/KlasnjaTitiunik-Brazil-data.dta"</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="kw">drop</span> <span class="kw">if</span> <span class="fu">missing</span>(mv_incparty)</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="kw">replace</span> population = population/1000</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="kw">replace</span> expend_total = expend_total/1000</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="kw">replace</span> revenue_total = revenue_total/1000</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<p>Now that everything is set up, I can replicate the main result from Table 2:</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">Stata</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>rd_l1 <span class="ot">&lt;-</span> <span class="fu">with</span>(df, <span class="fu">rdrobust</span>(inc_party_wonfor1_b1, mv_incparty))</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(rd_l1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Sharp RD estimates using local polynomial regression.

Number of Obs.                10010
BW type                       mserd
Kernel                   Triangular
VCE method                       NN

Number of Obs.                 4454         5556
Eff. Number of Obs.            2548         2758
Order est. (p)                    1            1
Order bias  (q)                   2            2
BW est. (h)                  13.566       13.566
BW bias (b)                  27.391       27.391
rho (h/b)                     0.495        0.495
Unique Obs.                    4441         5297

=============================================================================
        Method     Coef. Std. Err.         z     P&gt;|z|      [ 95% C.I. ]       
=============================================================================
  Conventional    -0.148     0.025    -5.866     0.000    [-0.197 , -0.098]    
        Robust         -         -    -5.532     0.000    [-0.213 , -0.101]    
=============================================================================</code></pre>
</div>
</div>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>rdrobust inc_party_wonfor1_b1 mv_incparty</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Sharp RD estimates using local polynomial regression.

      Cutoff c = 0 | Left of c  Right of c            Number of obs =      10010
-------------------+----------------------            BW type       =      mserd
     Number of obs |      4454        5556            Kernel        = Triangular
Eff. Number of obs |      2548        2758            VCE method    =         NN
    Order est. (p) |         1           1
    Order bias (q) |         2           2
       BW est. (h) |    13.566      13.566
       BW bias (b) |    27.391      27.391
         rho (h/b) |     0.495       0.495

Outcome: inc_party_wonfor1_b1. Running variable: mv_incparty.
--------------------------------------------------------------------------------
            Method |   Coef.    Std. Err.    z     P&gt;|z|    [95% Conf. Interval]
-------------------+------------------------------------------------------------
      Conventional | -.14758     .02516   -5.8663  0.000   -.196892     -.098275
            Robust |     -          -     -5.5322  0.000   -.212661     -.101395
--------------------------------------------------------------------------------</code></pre>
</div>
</div>
</div>
</div>
</div>
<p>The results generally replicate. They suggest that when an incumbent party barely wins the election at time <span class="math inline">\(t\)</span>, it is on average 15 percentage points less likely to win the following mayoral election at <span class="math inline">\(t+1\)</span> than when it barely loses. This effect is significantly different from zero, with the robust 95% confidence interval ranging from −21 to −10 percentage points.</p>
<p>Note that the point estimate and confidence interval are not exactly the same as in Table 2 of KT. I use the latest version of the <code>rdrobust</code> function, which calculates the MSE-optimal bandwidth differently than the 2014 version that Table 2 is based on. The resulting differences are negligible.</p>
</section>
<section id="tests" class="level3">
<h3 class="anchored" data-anchor-id="tests">Tests</h3>
<section id="test-1-rd-plot-of-main-model" class="level4">
<h4 class="anchored" data-anchor-id="test-1-rd-plot-of-main-model">Test 1: RD Plot of Main Model</h4>
<p>As a first step, researchers should plot the estimated model. RD designs lend themselves to visual inspection, as the link between the RD plot and the estimated treatment effect is particularly intuitive. RD plots typically consist of a set of binned outcome means, showing the variability in the underlying data, and a smooth line that visualizes the fitted model. From a testing perspective, RD plots can help assess the plausibility of the fitted model by showing whether it is supported by the underlying data. Moreover, small bandwidths with overly steep slopes are suggestive of overfitting (see <span class="citation" data-cites="albada2024overfitting">Albada (<a href="#ref-albada2024overfitting" role="doc-biblioref">2024b</a>)</span> for a discussion on overfitting).</p>
<p>The simplest way to construct an RD plot is through <code>rdplot</code> software <span class="citation" data-cites="calonico2015plot">(<a href="#ref-calonico2015plot" role="doc-biblioref">Calonico, Cattaneo, and Titiunik 2015</a>)</span>, which does most of the work for you. By default, the bin width is set with the variance mimicking method, as recommended by <span class="citation" data-cites="korting2023">Korting et al. (<a href="#ref-korting2023" role="doc-biblioref">2023</a>)</span>. In my experience, these bins accurately represent the underlying variance in large data sets, but can create too large bins in small data sets, say, of less than 1,000 observations. If this is the case, manually setting the bin width may be better. To plot the local linear model, one has to adjust the polynomial, kernel, and bandwidth settings, as shown in the code below:</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false">Stata</a></li></ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(df, <span class="fu">rdplot</span>(<span class="at">y=</span>inc_party_wonfor1_b1, <span class="at">x=</span>mv_incparty, <span class="at">p=</span><span class="dv">1</span>, <span class="at">kernel =</span> <span class="st">"triangular"</span>, <span class="at">h=</span>rd_l1<span class="sc">$</span>bws[<span class="dv">1</span>],</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">x.lim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">50</span>,<span class="dv">50</span>), <span class="at">col.dots =</span> <span class="st">"grey60"</span>, <span class="at">col.lines =</span> <span class="st">"black"</span>, <span class="at">y.lim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.6</span>),</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">x.label =</span> <span class="st">"Incumbent Party Vote Margin at t"</span>, </span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">y.label =</span> <span class="st">"Probability of Unconditional Victory at t+1"</span>, </span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">title =</span> <span class="st">"Main Model"</span>, <span class="at">nbins=</span><span class="fu">c</span>(<span class="dv">50</span>,<span class="dv">50</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="rdtesting_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>rdplot inc_party_wonfor1_b1 mv_incparty <span class="kw">if</span> <span class="fu">abs</span>(mv_incparty)&lt;=50, <span class="kw">p</span>(1) <span class="kw">h</span>(<span class="ot">`e(h_l)'</span>) <span class="co">/// </span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>kernel(triangular) graph_options(<span class="bn">legend</span>(<span class="kw">off</span>) <span class="bn">title</span>(<span class="st">"Main Model"</span>) <span class="co">/// </span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="bn">ytitle</span>(<span class="st">"Probability of Unconditional Victory at t+1"</span>) <span class="bn">xtitle</span>(<span class="st">"Incumbent Party Vote Margin at t"</span>))</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="kw">qui</span> <span class="kw">graph</span> <span class="kw">export</span> <span class="st">"rdplot.svg"</span>, <span class="kw">replace</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><img src="rdplot.svg" class="img-fluid"></p>
</div>
</div>
</div>
<p>The RD plot of the main model is convincing: (1) the binned means exhibit an upward-trending functional form within the bandwidth - one that does not rely on overaggregating the bins, (2) the binned means show a clear jump at the discontinuity, and (3) the model lines, while somewhat steep, nicely overlap the binned means. Overall, this plot provides support for the point estimate.</p>
</section>
<section id="test-2-density-test" class="level4">
<h4 class="anchored" data-anchor-id="test-2-density-test">Test 2: Density Test</h4>
<p>I next consider the identification assumption of the RD design: continuity of the conditional expectation functions of the treatment and control groups. Continuity will break down if observations have precise control over their running variable value and are thereby able to sort themselves into the treatment or control group. While directly testing for continuity is impossible, as the conditional expectation functions are not observed past the cutoff point, three tests make this assumption more plausible.</p>
<p>First is the density test. It evaluates whether the density of the running variable is continuous at the cutoff. <span class="citation" data-cites="mccrary2008">McCrary (<a href="#ref-mccrary2008" role="doc-biblioref">2008</a>)</span> based this test on the idea that if units are unable to precisely manipulate their value of the running variable, the number of units just above the cutoff should be similar to those just below. <span class="citation" data-cites="cattaneo2020simple">Cattaneo, Jansson, and Ma (<a href="#ref-cattaneo2020simple" role="doc-biblioref">2020</a>)</span> recently developed a local polynomial density estimator that offers an improvement over preceding tests in an RD setting. It is implemented using <code>rddensity</code> software. The null hypothesis of the density test assumes continuity. It is successful if the estimated discontinuity is statistically insignificant at conventional significance levels.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-4-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-1" role="tab" aria-controls="tabset-4-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-2" role="tab" aria-controls="tabset-4-2" aria-selected="false">Stata</a></li></ul>
<div class="tab-content">
<div id="tabset-4-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-4-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>dens_p <span class="ot">&lt;-</span> <span class="fu">with</span>(df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(inc_party_wonfor1_b1)), <span class="fu">rddensity</span>(mv_incparty))</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>dens_plot <span class="ot">&lt;-</span> <span class="fu">with</span>(df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(inc_party_wonfor1_b1)), </span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">rdplotdensity</span>(<span class="fu">rddensity</span>(mv_incparty), mv_incparty, <span class="at">plotRange =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">50</span>,<span class="dv">50</span>),</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">noPlot =</span> T, <span class="at">ylabel =</span> <span class="st">"Density"</span>, </span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">xlabel=</span><span class="st">"Incumbent Party Vote Margin at t"</span>))<span class="sc">$</span>Estplot</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>dens_plot <span class="ot">&lt;-</span> dens_plot <span class="sc">+</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom=</span><span class="st">"text"</span>, <span class="at">x=</span><span class="dv">20</span>, <span class="at">y=</span><span class="fl">0.022</span>, <span class="at">label=</span><span class="fu">paste</span>(<span class="st">"p-value ="</span>, <span class="fu">round</span>(dens_p<span class="sc">$</span>test<span class="sc">$</span>p_jk,<span class="dv">3</span>))) <span class="sc">+</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Cattaneo, Jansson &amp; Ma Density Test"</span>) <span class="sc">+</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust=</span><span class="fl">0.5</span>))</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>dens_plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="rdtesting_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-4-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="kw">qui</span> rddensity mv_incparty <span class="kw">if</span> !<span class="fu">missing</span>(inc_party_wonfor1_b1)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="kw">local</span> pval = <span class="fu">round</span>(<span class="fu">e</span>(pv_q), 0.01)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>rddensity mv_incparty <span class="kw">if</span> !<span class="fu">missing</span>(inc_party_wonfor1_b1), plot <span class="co">/// </span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>graph_opt(<span class="bn">title</span>(<span class="st">"Cattaneo, Jansson &amp; Ma Density Test"</span>) <span class="bn">ytitle</span>(<span class="st">"Density"</span>) <span class="co">/// </span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="bn">xtitle</span>(<span class="st">"Incumbent Party Vote Margin at t"</span>) <span class="st">`"</span>text(0.02 20 <span class="st">"p-value = `pval'"</span>)<span class="st">"' legend(off))</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="st">qui graph export "</span>densityplot.svg<span class="st">", replace</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><img src="densityplot.svg" class="img-fluid"></p>
</div>
</div>
</div>
<p>The plot summarizes the results from the density test. There is no evidence of sorting: the p-value is statistically insignificant and the histogram shows no heaping on either side of the discontinuity.</p>
<p>To make a stronger argument for continuity, researchers should apply an equivalence test framework to the density test. Instead of testing whether the densities on the left and right sides of the discontinuity are equal, the equivalence test assesses whether the ratio of densities is outside a pre-defined, substantively inconsequential range. Equivalence tests thus reverse the null hypothesis - they start off with the assumption that there is no continuity and challenge the researcher to provide sufficiently strong evidence of continuity. They are successful if the ratio’s confidence interval is small enough to entirely fall within the range, which only happens if the test has sufficient observations.</p>
<p>I set the substantively inconsequential range for the density ratio at [2/3, 1.5], following <span class="citation" data-cites="hartman2021">Hartman (<a href="#ref-hartman2021" role="doc-biblioref">2021</a>)</span> and <span class="citation" data-cites="fitzgerald2024">Fitzgerald (<a href="#ref-fitzgerald2024" role="doc-biblioref">2024</a>)</span>. Note that the definition of substantively inconsequential could differ in each context. Finally, as Hartman’s <span class="citation" data-cites="hartman2021">(<a href="#ref-hartman2021" role="doc-biblioref">2021</a>)</span> equivalence test is currently not available for Stata, I only show R code.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-5-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-1" role="tab" aria-controls="tabset-5-1" aria-selected="true">R</a></li></ul>
<div class="tab-content">
<div id="tabset-5-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-5-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>den_est <span class="ot">&lt;-</span> <span class="fu">with</span>(df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(inc_party_wonfor1_b1)), </span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>                <span class="fu">rddensity</span>(mv_incparty, <span class="at">vce =</span> <span class="st">"plugin"</span>))</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>equiv_den <span class="ot">&lt;-</span> <span class="fu">rdd.tost.ratio</span>(<span class="at">estL =</span> den_est<span class="sc">$</span>hat<span class="sc">$</span>left, <span class="at">estR =</span> den_est<span class="sc">$</span>hat<span class="sc">$</span>right, </span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>                            <span class="at">seL =</span> den_est<span class="sc">$</span>sd_asy<span class="sc">$</span>left, <span class="at">seR =</span> den_est<span class="sc">$</span>sd_asy<span class="sc">$</span>right, <span class="at">eps =</span> <span class="fl">1.5</span>)</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>equiv_den_out <span class="ot">&lt;-</span> <span class="fu">rbind</span>(<span class="st">"Observations"</span> <span class="ot">=</span> den_est<span class="sc">$</span>N<span class="sc">$</span>eff_left <span class="sc">+</span> den_est<span class="sc">$</span>N<span class="sc">$</span>eff_right, </span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>            <span class="st">"Ratio"</span> <span class="ot">=</span> <span class="fu">round</span>(den_est<span class="sc">$</span>hat<span class="sc">$</span>left <span class="sc">/</span> den_est<span class="sc">$</span>hat<span class="sc">$</span>right, <span class="dv">2</span>),</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>            <span class="st">"Equivalence CI"</span> <span class="ot">=</span> <span class="fu">paste0</span>(<span class="st">"["</span>, <span class="fu">round</span>(<span class="dv">1</span><span class="sc">/</span>equiv_den<span class="sc">$</span>inverted,<span class="dv">2</span>), <span class="st">", "</span>, <span class="fu">round</span>(equiv_den<span class="sc">$</span>inverted,<span class="dv">2</span>), <span class="st">"]"</span>),</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>            <span class="st">"P-value"</span> <span class="ot">=</span> <span class="fu">ifelse</span>(<span class="fu">round</span>(equiv_den<span class="sc">$</span>p,<span class="dv">2</span>)<span class="sc">==</span><span class="dv">0</span>,<span class="st">"&lt;0.01"</span>,<span class="fu">round</span>(equiv_den<span class="sc">$</span>p,<span class="dv">2</span>)))</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(equiv_den_out,</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">col.names =</span> <span class="cn">NA</span>) <span class="sc">%&gt;%</span> <span class="fu">column_spec</span>(<span class="dv">1</span>, <span class="at">bold=</span>T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left; font-weight: bold;">Observations</td>
<td style="text-align: left;">5692</td>
</tr>
<tr class="even">
<td style="text-align: left; font-weight: bold;">Ratio</td>
<td style="text-align: left;">0.99</td>
</tr>
<tr class="odd">
<td style="text-align: left; font-weight: bold;">Equivalence CI</td>
<td style="text-align: left;">[0.85, 1.17]</td>
</tr>
<tr class="even">
<td style="text-align: left; font-weight: bold;">P-value</td>
<td style="text-align: left;">&lt;0.01</td>
</tr>
</tbody>
</table>


</div>
</div>
</div>
</div>
</div>
<p>The resulting equivalence confidence interval is easily bound within the substantively inconsequential range and the p-value of the equivalence test is below the conventional 5% significance level.</p>
</section>
<section id="test-3-balance-test" class="level4">
<h4 class="anchored" data-anchor-id="test-3-balance-test">Test 3: Balance Test</h4>
<p>Balance tests, also known as pre-treatment covariates or outcome tests, compare treatment and control units on variables unrelated to the treatment. If units cannot manipulate their running variable value, there should be no discontinuous change in these pre-determined variables at the cutoff. Balance tests typically copy the standard estimation procedure but replace the outcome with a covariate or lagged outcome.</p>
<p>The code below replicates the balance test in Table S3 of KT. I estimate discontinuities for 13 covariates using a local linear model with an MSE-optimal bandwidth and triangular kernel. Test success is based on traditional null hypothesis significance testing (NHST), where insignificant estimates support the continuity assumption. As with the density test, I also apply Hartman’s <span class="citation" data-cites="hartman2021">(<a href="#ref-hartman2021" role="doc-biblioref">2021</a>)</span> equivalence test framework to the balance test. Instead of testing whether the confidence interval of the estimate includes zero, equivalence tests assess whether the confidence interval falls within a range that is deemed substantively inconsequential. Again, this ensures that insignificant estimates are not because of insufficient statistical power.</p>
<p>The substantively inconsequential range corresponds to a medium effect size according to Cohen’s <span class="math inline">\(d\)</span> - half the standard deviation of the outcome of control units within the MSE-optimal bandwidth. This is a lenient threshold, given that many effect sizes in the social sciences fall into the small effect size category.</p>
<p>As the balance test is usually conducted for many covariates, I also correct for multiple testing. This poses a problem in traditional null hypothesis testing: adding irrelevant, noisy covariates increases the number of hypotheses tested, thus reducing the probability of rejecting the null . In contrast, equivalence testing reverses the type 1 and type 2 errors, removing this concern. I therefore only apply multiple testing corrections to the p-values of the equivalence tests and not to those of the null hypothesis tests.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-6-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-1" role="tab" aria-controls="tabset-6-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-2" role="tab" aria-controls="tabset-6-2" aria-selected="false">Stata</a></li></ul>
<div class="tab-content">
<div id="tabset-6-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-6-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>covs <span class="ot">&lt;-</span> <span class="fu">with</span>(df, <span class="fu">list</span>(pibpc, population, winner_age, winner_educ, winner_male, </span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>                      numpar_candidates_eff, dnorte, dnordeste, dsul, dsudeste, </span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>                      dcentrooeste, revenue_total, expend_total))</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>equiv_cont_out <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(covs)){</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>  rd <span class="ot">&lt;-</span> <span class="fu">with</span>(df, <span class="fu">rdrobust</span>(covs[[i]], mv_incparty))</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>  eps_cont <span class="ot">&lt;-</span> <span class="fl">0.5</span><span class="sc">*</span><span class="fu">sd</span>(covs[[i]][df<span class="sc">$</span>mv_incparty<span class="sc">&lt;</span><span class="dv">0</span><span class="sc">&amp;</span>df<span class="sc">$</span>mv_incparty<span class="sc">&gt;-</span>rd<span class="sc">$</span>bws[<span class="dv">1</span>]], <span class="at">na.rm =</span> T)</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>  equiv_cont <span class="ot">&lt;-</span> <span class="fu">rdd.equiv</span>(rd<span class="sc">$</span>coef[<span class="dv">1</span>], rd<span class="sc">$</span>se[<span class="dv">3</span>], <span class="at">eps =</span> eps_cont)</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>  equiv_cont_out <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(equiv_cont_out, </span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">data.frame</span>(<span class="at">n_eff =</span> <span class="fu">sum</span>(rd<span class="sc">$</span>N_h),</span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">est =</span> <span class="fu">round</span>(rd<span class="sc">$</span>coef[<span class="dv">1</span>],<span class="dv">2</span>),</span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">p_val_nhst =</span> <span class="fu">round</span>(rd<span class="sc">$</span>pv[<span class="dv">3</span>],<span class="dv">2</span>),</span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">est_scaled =</span> <span class="fu">round</span>(rd<span class="sc">$</span>coef[<span class="dv">1</span>]<span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>eps_cont),<span class="dv">2</span>),</span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">equiv_ci =</span> <span class="fu">paste0</span>(<span class="st">"["</span>, <span class="sc">-</span><span class="fu">round</span>(equiv_cont<span class="sc">$</span>inverted<span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>eps_cont),<span class="dv">2</span>), <span class="st">", "</span>, <span class="fu">round</span>(equiv_cont<span class="sc">$</span>inverted<span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>eps_cont),<span class="dv">2</span>), <span class="st">"]"</span>),</span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">p_val =</span> <span class="fu">round</span>(equiv_cont<span class="sc">$</span>p,<span class="dv">2</span>)))</span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a>equiv_cont_out <span class="sc">%&lt;&gt;%</span> <span class="fu">mutate</span>(<span class="at">p_val=</span><span class="fu">round</span>(<span class="fu">p.adjust</span>(p_val, <span class="at">method=</span><span class="st">"fdr"</span>),<span class="dv">2</span>),</span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a>                           <span class="at">p_val=</span><span class="fu">ifelse</span>(p_val<span class="sc">==</span><span class="dv">0</span>,<span class="st">"&lt;0.01"</span>,p_val))</span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a><span class="fu">row.names</span>(equiv_cont_out) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Municipal GDP per capita"</span>, <span class="st">"Population"</span>, <span class="st">"Winner's Age"</span>, </span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"Winner's Education"</span>, <span class="st">"Winner Male"</span>, <span class="st">"Number of Effective Parties"</span>, </span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"Municipality in North"</span>, <span class="st">"Municipality in North-East"</span>, </span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"Municipality in South"</span>, <span class="st">"Municipality in South-East"</span>, </span>
<span id="cb12-32"><a href="#cb12-32" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"Municipality in Center-East"</span>, <span class="st">"Total Revenue"</span>, <span class="st">"Total Expenditure"</span>)</span>
<span id="cb12-33"><a href="#cb12-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-34"><a href="#cb12-34" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(equiv_cont_out,</span>
<span id="cb12-35"><a href="#cb12-35" aria-hidden="true" tabindex="-1"></a>      <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Observations"</span>, <span class="st">"Estimate"</span>, <span class="st">"P-value NHST"</span>, <span class="st">"Standardized Estimate"</span>, </span>
<span id="cb12-36"><a href="#cb12-36" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"Equivalence CI"</span>, <span class="st">"Equivalence p-value"</span>),</span>
<span id="cb12-37"><a href="#cb12-37" aria-hidden="true" tabindex="-1"></a>      <span class="at">align =</span> <span class="st">"c"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 22%">
<col style="width: 11%">
<col style="width: 7%">
<col style="width: 11%">
<col style="width: 18%">
<col style="width: 12%">
<col style="width: 16%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: center;">Observations</th>
<th style="text-align: center;">Estimate</th>
<th style="text-align: center;">P-value NHST</th>
<th style="text-align: center;">Standardized Estimate</th>
<th style="text-align: center;">Equivalence CI</th>
<th style="text-align: center;">Equivalence p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Municipal GDP per capita</td>
<td style="text-align: center;">7366</td>
<td style="text-align: center;">-149.92</td>
<td style="text-align: center;">0.85</td>
<td style="text-align: center;">-0.02</td>
<td style="text-align: center;">[-0.1, 0.1]</td>
<td style="text-align: center;">&lt;0.01</td>
</tr>
<tr class="even">
<td style="text-align: left;">Population</td>
<td style="text-align: center;">5057</td>
<td style="text-align: center;">-0.02</td>
<td style="text-align: center;">0.86</td>
<td style="text-align: center;">0.00</td>
<td style="text-align: center;">[NA, NA]</td>
<td style="text-align: center;">&lt;0.01</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Winner’s Age</td>
<td style="text-align: center;">7549</td>
<td style="text-align: center;">1.24</td>
<td style="text-align: center;">0.01</td>
<td style="text-align: center;">0.12</td>
<td style="text-align: center;">[-0.21, 0.21]</td>
<td style="text-align: center;">&lt;0.01</td>
</tr>
<tr class="even">
<td style="text-align: left;">Winner’s Education</td>
<td style="text-align: center;">7929</td>
<td style="text-align: center;">-0.03</td>
<td style="text-align: center;">0.83</td>
<td style="text-align: center;">-0.02</td>
<td style="text-align: center;">[-0.09, 0.09]</td>
<td style="text-align: center;">&lt;0.01</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Winner Male</td>
<td style="text-align: center;">7432</td>
<td style="text-align: center;">0.00</td>
<td style="text-align: center;">0.89</td>
<td style="text-align: center;">0.01</td>
<td style="text-align: center;">[-0.06, 0.06]</td>
<td style="text-align: center;">&lt;0.01</td>
</tr>
<tr class="even">
<td style="text-align: left;">Number of Effective Parties</td>
<td style="text-align: center;">6721</td>
<td style="text-align: center;">-0.04</td>
<td style="text-align: center;">0.17</td>
<td style="text-align: center;">-0.07</td>
<td style="text-align: center;">[-0.17, 0.17]</td>
<td style="text-align: center;">&lt;0.01</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Municipality in North</td>
<td style="text-align: center;">6038</td>
<td style="text-align: center;">-0.02</td>
<td style="text-align: center;">0.09</td>
<td style="text-align: center;">-0.09</td>
<td style="text-align: center;">[-0.2, 0.2]</td>
<td style="text-align: center;">&lt;0.01</td>
</tr>
<tr class="even">
<td style="text-align: left;">Municipality in North-East</td>
<td style="text-align: center;">6879</td>
<td style="text-align: center;">0.01</td>
<td style="text-align: center;">0.75</td>
<td style="text-align: center;">0.01</td>
<td style="text-align: center;">[-0.09, 0.09]</td>
<td style="text-align: center;">&lt;0.01</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Municipality in South</td>
<td style="text-align: center;">7499</td>
<td style="text-align: center;">0.03</td>
<td style="text-align: center;">0.16</td>
<td style="text-align: center;">0.07</td>
<td style="text-align: center;">[-0.16, 0.16]</td>
<td style="text-align: center;">&lt;0.01</td>
</tr>
<tr class="even">
<td style="text-align: left;">Municipality in South-East</td>
<td style="text-align: center;">7422</td>
<td style="text-align: center;">-0.01</td>
<td style="text-align: center;">0.39</td>
<td style="text-align: center;">-0.03</td>
<td style="text-align: center;">[-0.12, 0.12]</td>
<td style="text-align: center;">&lt;0.01</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Municipality in Center-East</td>
<td style="text-align: center;">7248</td>
<td style="text-align: center;">0.00</td>
<td style="text-align: center;">0.88</td>
<td style="text-align: center;">-0.01</td>
<td style="text-align: center;">[-0.09, 0.09]</td>
<td style="text-align: center;">&lt;0.01</td>
</tr>
<tr class="even">
<td style="text-align: left;">Total Revenue</td>
<td style="text-align: center;">3459</td>
<td style="text-align: center;">-2845.65</td>
<td style="text-align: center;">0.33</td>
<td style="text-align: center;">-0.06</td>
<td style="text-align: center;">[-0.15, 0.15]</td>
<td style="text-align: center;">&lt;0.01</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Total Expenditure</td>
<td style="text-align: center;">3368</td>
<td style="text-align: center;">-2616.67</td>
<td style="text-align: center;">0.37</td>
<td style="text-align: center;">-0.05</td>
<td style="text-align: center;">[-0.14, 0.14]</td>
<td style="text-align: center;">&lt;0.01</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="tabset-6-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="kw">preserve</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>postutil <span class="kw">clear</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="kw">tempfile</span> results</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="kw">postfile</span> <span class="kw">table</span> str26 Variable Observations Estimate str20 CI P_value <span class="kw">using</span> <span class="ot">`results'</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="kw">local</span> <span class="fu">count</span> = 1</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="kw">foreach</span> <span class="kw">var</span> <span class="kw">of</span> <span class="kw">varlist</span> pibpc population winner* numpar_candidates_eff dnorte <span class="co">/// </span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>dnordeste dsul dsudeste dcentrooeste revenue_total expend_total {</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">qui</span> rdrobust <span class="ot">`var'</span> mv_incparty</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">local</span> <span class="kw">label</span> : <span class="kw">variable</span> <span class="kw">label</span> <span class="ot">`var'</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">local</span> ci_l = <span class="fu">round</span>(<span class="fu">e</span>(ci_l_rb), 0.01)</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>    <span class="kw">local</span> ci_r = <span class="fu">round</span>(<span class="fu">e</span>(ci_r_rb), 0.01)</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>    <span class="kw">post</span> <span class="kw">table</span> (<span class="st">"`label'"</span>) (<span class="fu">e</span>(N_h_l) + <span class="fu">e</span>(N_h_r)) (<span class="fu">round</span>(<span class="fu">e</span>(tau_cl), 0.001)) <span class="co">///</span></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>      (<span class="st">`"</span>[<span class="ot">`ci_l'</span>, <span class="ot">`ci_r'</span>]<span class="st">"') (round(e(pv_rb), 0.01))</span></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a><span class="st">postclose table</span></span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a><span class="st">use `results', clear </span></span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a><span class="st">list, clean noobs</span></span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a><span class="st">restore</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  2.         qui rdrobust `var' mv_incparty
  3.         
  7. }

                      Variable   Observ~s    Estimate                    CI   P_value  
      Municipal GDP per capita       7366    -149.918    [-1205.78, 992.35]       .85  
                    Population       5057       -.023         [-3.79, 4.54]       .86  
            Winner's education       7929       -.029           [-.21, .17]       .83  
    Winner's gender (male = 1)       7432        .002           [-.03, .03]       .89  
                  Winner's age       7549       1.238           [.31, 2.45]       .01  
    Effective number of partie       6721       -.036            [-.1, .02]       .17  
          Located in the north       6038       -.023             [-.06, 0]       .09  
     Located in the north-east       6879        .006           [-.04, .06]       .75  
          Located in the south       7499        .029           [-.01, .08]       .16  
     Located in the south-east       7422       -.015           [-.07, .03]       .39  
    Located in the center-east       7248       -.004           [-.03, .03]       .88  
                 Total revenue       3459   -2845.651   [-7920.39, 2663.77]       .33  
             Total expenditure       3368   -2616.667   [-7381.46, 2740.15]       .37  </code></pre>
</div>
</div>
</div>
</div>
</div>
<p>Note that the point estimates and confidence intervals differ from those in Table S3 of KT. This is again due to the older version of <code>rdrobust</code>, leading to different bandwidths. However, KT also incorrectly label the covariates. For example, in Table S3, the correct coefficient for the GDP per capita is given for the North variable.</p>
<p>Using the NHST balance test, winner’s age yields a statistically significant estimate at the 5% level (p-value &lt;0.01). Although a single significant estimate could simply be a type 1 error, it is important to consider whether the estimate is substantive. On the face of it, just over one age year difference does not sound alarming. When standardizing the estimate, we can see that 1.24 is 0.12 of the winner’s age variable standard deviation, also a relatively small effect size. Finally, the equivalence confidence interval is [-0.21, 0.21], which is clearly bound within the inconsequential range of [-0.5, 0.5]. I would therefore argue that the significant NHST is of little practical concern. Together with all the other significant equivalence test p-values, the balance test seems to support the continuity assumption.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></p>
</section>
<section id="test-4-donut-rd" class="level4">
<h4 class="anchored" data-anchor-id="test-4-donut-rd">Test 4: Donut RD</h4>
<p>The donut RD, introduced by <span class="citation" data-cites="barreca2011">Barreca et al. (<a href="#ref-barreca2011" role="doc-biblioref">2011</a>)</span>, is a test that considers the influence of the observations closest to the cutoff. It removes the observations just above and below the cutoff and re-estimates the treatment effect using the main model specification. If units sort themselves, they might only do so very close to the cutoff, and excluding these units should therefore substantially change the treatment estimate.</p>
<p>To ensure that not too many observations are removed, potentially creating a model without any support near the discontinuity, I limit the maximum donut hole size. It excludes at most an arbitrary 5% of the sample (i.e.&nbsp;an incumbent party vote margin of approximately 1%).</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-7-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-1" role="tab" aria-controls="tabset-7-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-2" role="tab" aria-controls="tabset-7-2" aria-selected="false">Stata</a></li></ul>
<div class="tab-content">
<div id="tabset-7-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-7-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>donut_range <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.2</span>)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>est <span class="ot">&lt;-</span> <span class="fu">vector</span>()</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>ci_l <span class="ot">&lt;-</span> <span class="fu">vector</span>()</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>ci_r <span class="ot">&lt;-</span> <span class="fu">vector</span>()</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>counter <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (donut <span class="cf">in</span> donut_range) {</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>  rd <span class="ot">&lt;-</span> <span class="fu">with</span>(df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">abs</span>(mv_incparty)<span class="sc">&gt;=</span>donut), <span class="fu">rdrobust</span>(inc_party_wonfor1_b1, mv_incparty))</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>  est[counter] <span class="ot">&lt;-</span> rd<span class="sc">$</span>Estimate[<span class="dv">1</span>]</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>  ci_l[counter] <span class="ot">&lt;-</span> rd<span class="sc">$</span>ci[<span class="dv">3</span>,<span class="dv">1</span>] </span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>  ci_r[counter] <span class="ot">&lt;-</span> rd<span class="sc">$</span>ci[<span class="dv">3</span>,<span class="dv">2</span>]</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>  counter <span class="ot">&lt;-</span> counter <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>donut_out <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(donut_range, est, ci_l, ci_r)</span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>donut_out <span class="sc">%&lt;&gt;%</span> <span class="fu">mutate</span>(<span class="at">sig=</span><span class="sc">!</span>(ci_l<span class="sc">&lt;</span><span class="dv">0</span><span class="sc">&amp;</span>ci_r<span class="sc">&gt;</span><span class="dv">0</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>donut_out <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(donut_range, est, <span class="at">col=</span><span class="fu">factor</span>(sig, <span class="at">level=</span><span class="fu">c</span>(T, F)))) <span class="sc">+</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">col=</span><span class="st">"grey30"</span>) <span class="sc">+</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin=</span>ci_l, <span class="at">ymax=</span>ci_r)) <span class="sc">+</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"rect"</span>, <span class="at">xmin =</span> <span class="sc">-</span><span class="fl">0.1</span>, <span class="at">xmax =</span> <span class="fl">0.1</span>, <span class="at">ymin =</span> <span class="sc">-</span><span class="fl">0.3</span>, <span class="at">ymax =</span> <span class="fl">0.05</span>, <span class="at">alpha =</span> .<span class="dv">15</span>) <span class="sc">+</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>), <span class="at">limits=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.3</span>,<span class="fl">0.05</span>)) <span class="sc">+</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand=</span><span class="fu">c</span>(<span class="fl">0.02</span>,<span class="fl">0.02</span>), <span class="at">breaks=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.2</span>,<span class="fl">0.4</span>,<span class="fl">0.6</span>,<span class="fl">0.8</span>,<span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">breaks=</span><span class="fu">c</span>(T,F), <span class="at">values=</span><span class="fu">c</span>(<span class="st">"black"</span>, <span class="st">"grey60"</span>)) <span class="sc">+</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Donut Size"</span>,</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">y=</span><span class="st">"Estimated Treatment Effect"</span>) <span class="sc">+</span></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="rdtesting_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-7-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="kw">preserve</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>postutil <span class="kw">clear</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="kw">tempfile</span> results</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="kw">postfile</span> <span class="kw">table</span> donut <span class="kw">est</span> ci_l ci_r <span class="kw">using</span> <span class="ot">`results'</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="kw">forvalues</span> <span class="kw">d</span>=0(0.2)1 {</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">qui</span> rdrobust inc_party_wonfor1_b1 mv_incparty <span class="kw">if</span> <span class="fu">abs</span>(mv_incparty)&gt;=<span class="ot">`d'</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>       <span class="kw">post</span> <span class="kw">table</span> (<span class="ot">`d'</span>) (<span class="fu">e</span>(tau_cl)) (<span class="fu">e</span>(ci_l_rb)) (<span class="fu">e</span>(ci_r_rb))</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a><span class="kw">postclose</span> <span class="kw">table</span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a><span class="kw">use</span> <span class="ot">`results'</span>, <span class="kw">clear</span> </span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a><span class="kw">scatter</span> <span class="kw">est</span> donut, mc(<span class="bn">black</span>) || rcap ci_r ci_l donut, lc(<span class="bn">black</span>) ||, <span class="kw">yline</span>(0) <span class="co">///</span></span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>  <span class="bn">xtitle</span>(<span class="st">"Donut Size"</span>, <span class="bn">margin</span>(small)) <span class="bn">ytitle</span>(<span class="st">"RD Treatment Effect"</span>, <span class="bn">margin</span>(small)) <span class="co">/// </span></span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>  <span class="bn">legend</span>(<span class="kw">off</span>) graphregion(<span class="kw">color</span>(<span class="bn">white</span>)) <span class="bn">yscale</span>(<span class="kw">range</span>(-0.25 0.05)) <span class="kw">ylabel</span>(-0.25(0.05)0.05)</span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a><span class="kw">qui</span> <span class="kw">graph</span> <span class="kw">export</span> <span class="st">"donutplot.svg"</span>, <span class="kw">replace</span></span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a><span class="kw">restore</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><img src="donutplot.svg" class="img-fluid" style="width:70.0%"></p>
</div>
</div>
</div>
<p>All estimated treatment effects and their corresponding confidence intervals are very similar to the ones from the main model. The donut RD test thus gives no reason to suspect intentional sorting.</p>
</section>
<section id="test-5-bandwidth" class="level4">
<h4 class="anchored" data-anchor-id="test-5-bandwidth">Test 5: Bandwidth</h4>
<p>In the next set of tests, I assess whether results are sensitive to the model specification. These tests alter parameters from the main model and re-estimate the treatment effect. For results to be robust, estimates should remain consistent in terms of sign, statistical significance and effect size.</p>
<p>The bandwidth determines the width around the cutoff for which the local polynomial model approximates the conditional expectation functions. Bandwidth tests adjust the MSE-optimal bandwidth to smaller or larger sizes, assessing sensitivity to units at the end points of the bandwidth. When conducting bandwidth sensitivity tests, it is important to be aware that models with too small or too large bandwidths can be uninformative. For small bandwidths, the variance can become too high, and for large bandwidths, there can be substantial approximation bias. In this case, I limit the bandwidth range between half and twice the MSE-optimal bandwidth (13.57).</p>
<p>Also note that because bandwidth sensitivity tests rely on manually setting the bandwidth, it is impossible to conduct robust RD inference. Instead, the bandwidth plot below shows conventional 95% confidence intervals.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-8-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-1" role="tab" aria-controls="tabset-8-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-2" role="tab" aria-controls="tabset-8-2" aria-selected="false">Stata</a></li></ul>
<div class="tab-content">
<div id="tabset-8-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-8-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>bw_range <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">0.5</span><span class="sc">*</span>rd_l1<span class="sc">$</span>bws[<span class="dv">1</span>],<span class="dv">2</span><span class="sc">*</span>rd_l1<span class="sc">$</span>bws[<span class="dv">1</span>],<span class="fl">0.5</span>)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>est <span class="ot">&lt;-</span> <span class="fu">vector</span>()</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>ci_l <span class="ot">&lt;-</span> <span class="fu">vector</span>()</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>ci_r <span class="ot">&lt;-</span> <span class="fu">vector</span>()</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>counter <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (bw <span class="cf">in</span> bw_range) {</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>  rd <span class="ot">&lt;-</span> <span class="fu">with</span>(df, <span class="fu">rdrobust</span>(inc_party_wonfor1_b1, mv_incparty, <span class="at">h=</span>bw))</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>  est[counter] <span class="ot">&lt;-</span> rd<span class="sc">$</span>Estimate[<span class="dv">1</span>]</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>  ci_l[counter] <span class="ot">&lt;-</span> rd<span class="sc">$</span>ci[<span class="dv">1</span>,<span class="dv">1</span>] </span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>  ci_r[counter] <span class="ot">&lt;-</span> rd<span class="sc">$</span>ci[<span class="dv">1</span>,<span class="dv">2</span>]</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>  counter <span class="ot">&lt;-</span> counter <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>bw_out <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(bw_range, est, ci_l, ci_r)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>bw_out <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(bw_range, est)) <span class="sc">+</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">col=</span><span class="st">"grey30"</span>) <span class="sc">+</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(bw_range, ci_l), <span class="at">col=</span><span class="st">"grey60"</span>, <span class="at">linetype=</span><span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(bw_range, ci_r), <span class="at">col=</span><span class="st">"grey60"</span>, <span class="at">linetype=</span><span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y=</span><span class="st">"Estimated Treatment Effect"</span>,</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">x=</span><span class="st">"Bandwidth Size"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="rdtesting_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-8-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="kw">preserve</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>postutil <span class="kw">clear</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="kw">tempfile</span> results</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="kw">postfile</span> <span class="kw">table</span> bw <span class="kw">est</span> ci_l ci_r <span class="kw">using</span> <span class="ot">`results'</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a><span class="kw">local</span> bw_min = <span class="fu">round</span>(0.5*<span class="fu">e</span>(h_l),1)</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a><span class="kw">local</span> bw_max = <span class="fu">round</span>(2*<span class="fu">e</span>(h_l),1)</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a><span class="kw">forvalues</span> bw=<span class="ot">`bw_min'</span>(1)<span class="ot">`bw_max'</span> {</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">qui</span> rdrobust inc_party_wonfor1_b1 mv_incparty, <span class="kw">h</span>(<span class="ot">`bw'</span>)</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>    <span class="kw">post</span> <span class="kw">table</span> (<span class="ot">`bw'</span>) (<span class="fu">e</span>(tau_cl)) (<span class="fu">e</span>(ci_l_cl)) (<span class="fu">e</span>(ci_r_cl))</span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a><span class="kw">postclose</span> <span class="kw">table</span></span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a><span class="kw">use</span> <span class="ot">`results'</span>, <span class="kw">clear</span> </span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a><span class="kw">scatter</span> <span class="kw">est</span> bw, mc(<span class="bn">black</span>) || rcap ci_r ci_l bw, lc(<span class="bn">black</span>) ||, <span class="kw">yline</span>(0) <span class="co">/// </span></span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>  <span class="bn">xtitle</span>(<span class="st">"Bandwidth"</span>, <span class="bn">margin</span>(small)) <span class="bn">ytitle</span>(<span class="st">"RD Treatment Effect"</span>, <span class="bn">margin</span>(small)) <span class="co">/// </span></span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a>  <span class="bn">legend</span>(<span class="kw">off</span>) graphregion(<span class="kw">color</span>(<span class="bn">white</span>)) <span class="bn">yscale</span>(<span class="kw">range</span>(-0.25 0.05)) <span class="kw">ylabel</span>(-0.25(0.05)0.05)</span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a><span class="kw">qui</span> <span class="kw">graph</span> <span class="kw">export</span> <span class="st">"bwplot.svg"</span>, <span class="kw">replace</span></span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a><span class="kw">restore</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><img src="bwplot.svg" class="img-fluid" style="width:80.0%"></p>
</div>
</div>
</div>
<p>The treatment estimate is stable across all bandwidth sizes, staying within a -0.125 and -0.15 range. Although the confidence intervals widen as the bandwidth gets close to its smallest size, all estimates are statistically significant. The estimate from the main model does not appear to be sensitive to the bandwidth choice.</p>
</section>
<section id="test-6-polynomial" class="level4">
<h4 class="anchored" data-anchor-id="test-6-polynomial">Test 6: Polynomial</h4>
<p>The polynomial order controls the functional form with which to approximate the conditional expectation functions. Instead of linear functional form, researchers can estimate the treatment effect with a quadratic or cubic one. These models helps detect remaining nonlinearities within the bandwidth that may bias the local linear model. They also require a different bandwidth, namely the one that is MSE-optimal for a quadratic or cubic specification.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-9-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-1" role="tab" aria-controls="tabset-9-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-2" role="tab" aria-controls="tabset-9-2" aria-selected="false">Stata</a></li></ul>
<div class="tab-content">
<div id="tabset-9-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-9-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>rd_l2 <span class="ot">&lt;-</span> <span class="fu">with</span>(df, <span class="fu">rdrobust</span>(inc_party_wonfor1_b1, mv_incparty, <span class="at">p=</span><span class="dv">2</span>))</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>rd_l3 <span class="ot">&lt;-</span> <span class="fu">with</span>(df, <span class="fu">rdrobust</span>(inc_party_wonfor1_b1, mv_incparty, <span class="at">p=</span><span class="dv">3</span>))</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>pol_out <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">mod=</span><span class="fu">c</span>(<span class="st">"Main"</span>, <span class="st">"Local 2nd"</span>, <span class="st">"Local 3rd"</span>), </span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>                      <span class="at">est=</span><span class="fu">c</span>(rd_l1<span class="sc">$</span>coef[<span class="dv">1</span>], rd_l2<span class="sc">$</span>coef[<span class="dv">1</span>], rd_l3<span class="sc">$</span>coef[<span class="dv">1</span>]), </span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>                      <span class="at">ci_l=</span><span class="fu">c</span>(rd_l1<span class="sc">$</span>ci[<span class="dv">3</span>,<span class="dv">1</span>], rd_l2<span class="sc">$</span>ci[<span class="dv">3</span>,<span class="dv">1</span>], rd_l3<span class="sc">$</span>ci[<span class="dv">3</span>,<span class="dv">1</span>]), </span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>                      <span class="at">ci_r=</span><span class="fu">c</span>(rd_l1<span class="sc">$</span>ci[<span class="dv">3</span>,<span class="dv">2</span>], rd_l2<span class="sc">$</span>ci[<span class="dv">3</span>,<span class="dv">2</span>], rd_l3<span class="sc">$</span>ci[<span class="dv">3</span>,<span class="dv">2</span>]))</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>pol_out <span class="sc">%&lt;&gt;%</span> <span class="fu">mutate</span>(<span class="at">sig=</span><span class="sc">!</span>(ci_l<span class="sc">&lt;</span><span class="dv">0</span><span class="sc">&amp;</span>ci_r<span class="sc">&gt;</span><span class="dv">0</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>pol_out <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="fu">factor</span>(mod, <span class="at">level=</span><span class="fu">unique</span>(mod)), est, <span class="at">col=</span><span class="fu">factor</span>(sig, <span class="at">level=</span><span class="fu">c</span>(T, F)))) <span class="sc">+</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">col=</span><span class="st">"grey30"</span>) <span class="sc">+</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin=</span>ci_l, <span class="at">ymax=</span>ci_r)) <span class="sc">+</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"rect"</span>, <span class="at">xmin =</span> <span class="fl">0.5</span>, <span class="at">xmax =</span> <span class="fl">1.5</span>, <span class="at">ymin =</span> <span class="sc">-</span><span class="fl">0.25</span>, <span class="at">ymax =</span> <span class="fl">0.05</span>, <span class="at">alpha =</span> .<span class="dv">15</span>) <span class="sc">+</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>), <span class="at">limits=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.25</span>,<span class="fl">0.05</span>)) <span class="sc">+</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">breaks=</span><span class="fu">c</span>(T,F), <span class="at">values=</span><span class="fu">c</span>(<span class="st">"black"</span>, <span class="st">"grey60"</span>)) <span class="sc">+</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Model"</span>,</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">y=</span><span class="st">"Estimated Treatment Effect"</span>) <span class="sc">+</span></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="rdtesting_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-9-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="kw">preserve</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>postutil <span class="kw">clear</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="kw">tempfile</span> results</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="kw">postfile</span> <span class="kw">table</span> <span class="fu">mod</span> <span class="kw">est</span> ci_l ci_r <span class="kw">using</span> <span class="ot">`results'</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a><span class="kw">qui</span> rdrobust inc_party_wonfor1_b1 mv_incparty</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a><span class="kw">post</span> <span class="kw">table</span> (1) (<span class="fu">e</span>(tau_cl)) (<span class="fu">e</span>(ci_l_rb)) (<span class="fu">e</span>(ci_r_rb))</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a><span class="kw">qui</span> rdrobust inc_party_wonfor1_b1 mv_incparty, <span class="kw">p</span>(2)</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a><span class="kw">post</span> <span class="kw">table</span> (2) (<span class="fu">e</span>(tau_cl)) (<span class="fu">e</span>(ci_l_rb)) (<span class="fu">e</span>(ci_r_rb))</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a><span class="kw">qui</span> rdrobust inc_party_wonfor1_b1 mv_incparty, <span class="kw">p</span>(3)</span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a><span class="kw">post</span> <span class="kw">table</span> (3) (<span class="fu">e</span>(tau_cl)) (<span class="fu">e</span>(ci_l_rb)) (<span class="fu">e</span>(ci_r_rb))</span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a><span class="kw">postclose</span> <span class="kw">table</span></span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a><span class="kw">use</span> <span class="ot">`results'</span>, <span class="kw">clear</span> </span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a><span class="kw">label</span> def mods 1 <span class="st">"Main"</span> 2 <span class="st">"Local 2nd"</span> 3 <span class="st">"Local 3rd"</span> </span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a><span class="kw">label</span> val <span class="fu">mod</span> mods</span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-22"><a href="#cb23-22" aria-hidden="true" tabindex="-1"></a><span class="kw">scatter</span> <span class="kw">est</span> <span class="fu">mod</span>, mc(<span class="bn">black</span>) <span class="kw">xlabel</span>(1/3, valuelabel) || rcap ci_r ci_l <span class="fu">mod</span>, lc(<span class="bn">black</span>) ||, <span class="co">/// </span></span>
<span id="cb23-23"><a href="#cb23-23" aria-hidden="true" tabindex="-1"></a>  <span class="kw">yline</span>(0) <span class="bn">xtitle</span>(<span class="st">"Model"</span>, <span class="bn">margin</span>(small)) <span class="bn">ytitle</span>(<span class="st">"RD Treatment Effect"</span>, <span class="bn">margin</span>(small)) <span class="co">/// </span></span>
<span id="cb23-24"><a href="#cb23-24" aria-hidden="true" tabindex="-1"></a>  <span class="bn">legend</span>(<span class="kw">off</span>) graphregion(<span class="kw">color</span>(<span class="bn">white</span>)) <span class="bn">xscale</span>(<span class="kw">range</span>(0.5 3.5)) <span class="bn">yscale</span>(<span class="kw">range</span>(-0.25 0.05)) <span class="co">/// </span></span>
<span id="cb23-25"><a href="#cb23-25" aria-hidden="true" tabindex="-1"></a>  <span class="kw">ylabel</span>(-0.25(0.05)0.05)</span>
<span id="cb23-26"><a href="#cb23-26" aria-hidden="true" tabindex="-1"></a><span class="kw">qui</span> <span class="kw">graph</span> <span class="kw">export</span> <span class="st">"polplot.svg"</span>, <span class="kw">replace</span></span>
<span id="cb23-27"><a href="#cb23-27" aria-hidden="true" tabindex="-1"></a><span class="kw">restore</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><img src="polplot.svg" class="img-fluid" style="width:70.0%"></p>
</div>
</div>
</div>
<p>All local models yield statistically significant negative estimates, supporting the findings from the main model. While the estimate from the local third-order polynomial is somewhat smaller (-0.13 compared to the -0.15 of the main model), the effect size difference is within reasonable limits.</p>
</section>
<section id="test-7-kernel" class="level4">
<h4 class="anchored" data-anchor-id="test-7-kernel">Test 7: Kernel</h4>
<p>The final model specification test alters the weighting kernel. As opposed to the default triangular kernel, which gives more weight to units near the cutoff, the uniform kernel weights all units equally. Changing to a uniform kernel therefore tests sensitivity to the units near the discontinuity. In most applications, the kernel is an inconsequential modeling choice - if findings are sensitive to the kernel, they will likely be sensitive to other tests as well.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-10-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-1" role="tab" aria-controls="tabset-10-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-10-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-2" role="tab" aria-controls="tabset-10-2" aria-selected="false">Stata</a></li></ul>
<div class="tab-content">
<div id="tabset-10-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-10-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>unifkern <span class="ot">&lt;-</span> <span class="fu">with</span>(df, <span class="fu">rdrobust</span>(inc_party_wonfor1_b1, mv_incparty, <span class="at">kernel=</span><span class="st">"uniform"</span>))</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>kern_out <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">mod=</span><span class="fu">c</span>(<span class="st">"Main"</span>, <span class="st">"Uniform</span><span class="sc">\n</span><span class="st">Kernel"</span>), </span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">est=</span><span class="fu">c</span>(rd_l1<span class="sc">$</span>coef[<span class="dv">1</span>], unifkern<span class="sc">$</span>coef[<span class="dv">1</span>]), </span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">ci_l=</span><span class="fu">c</span>(rd_l1<span class="sc">$</span>ci[<span class="dv">3</span>,<span class="dv">1</span>], unifkern<span class="sc">$</span>ci[<span class="dv">3</span>,<span class="dv">1</span>]), </span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>                       <span class="at">ci_r=</span><span class="fu">c</span>(rd_l1<span class="sc">$</span>ci[<span class="dv">3</span>,<span class="dv">2</span>], unifkern<span class="sc">$</span>ci[<span class="dv">3</span>,<span class="dv">2</span>]))</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>kern_out <span class="sc">%&lt;&gt;%</span> <span class="fu">mutate</span>(<span class="at">sig=</span><span class="sc">!</span>(ci_l<span class="sc">&lt;</span><span class="dv">0</span><span class="sc">&amp;</span>ci_r<span class="sc">&gt;</span><span class="dv">0</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>kern_out <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="fu">factor</span>(mod, <span class="at">level=</span><span class="fu">unique</span>(mod)), est, <span class="at">col=</span><span class="fu">factor</span>(sig, <span class="at">level=</span><span class="fu">c</span>(T,F)))) <span class="sc">+</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">col=</span><span class="st">"grey30"</span>) <span class="sc">+</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin=</span>ci_l, <span class="at">ymax=</span>ci_r)) <span class="sc">+</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"rect"</span>, <span class="at">xmin =</span> <span class="fl">0.5</span>, <span class="at">xmax =</span> <span class="fl">1.5</span>, <span class="at">ymin =</span> <span class="sc">-</span><span class="fl">0.25</span>, <span class="at">ymax =</span> <span class="fl">0.05</span>, <span class="at">alpha =</span> .<span class="dv">15</span>) <span class="sc">+</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>), <span class="at">limits=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.25</span>,<span class="fl">0.05</span>)) <span class="sc">+</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">breaks=</span><span class="fu">c</span>(T,F), <span class="at">values=</span><span class="fu">c</span>(<span class="st">"black"</span>, <span class="st">"grey60"</span>)) <span class="sc">+</span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Model"</span>,</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">y=</span><span class="st">"Estimated Treatment Effect"</span>) <span class="sc">+</span></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="rdtesting_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid figure-img" width="384"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-10-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-10-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="kw">preserve</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>postutil <span class="kw">clear</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="kw">tempfile</span> results</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="kw">postfile</span> <span class="kw">table</span> <span class="fu">mod</span> <span class="kw">est</span> ci_l ci_r <span class="kw">using</span> <span class="ot">`results'</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a><span class="kw">qui</span> rdrobust inc_party_wonfor1_b1 mv_incparty</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a><span class="kw">post</span> <span class="kw">table</span> (1) (<span class="fu">e</span>(tau_cl)) (<span class="fu">e</span>(ci_l_rb)) (<span class="fu">e</span>(ci_r_rb))</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a><span class="kw">qui</span> rdrobust inc_party_wonfor1_b1 mv_incparty, kernel(uniform)</span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a><span class="kw">post</span> <span class="kw">table</span> (2) (<span class="fu">e</span>(tau_cl)) (<span class="fu">e</span>(ci_l_rb)) (<span class="fu">e</span>(ci_r_rb))</span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a><span class="kw">postclose</span> <span class="kw">table</span></span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a><span class="kw">use</span> <span class="ot">`results'</span>, <span class="kw">clear</span> </span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a><span class="kw">label</span> def mods 1 <span class="st">"Main"</span> 2 <span class="st">"Uniform Kernel"</span></span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a><span class="kw">label</span> val <span class="fu">mod</span> mods</span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a><span class="kw">scatter</span> <span class="kw">est</span> <span class="fu">mod</span>, mc(<span class="bn">black</span>) <span class="kw">xlabel</span>(1/2, valuelabel) || rcap ci_r ci_l <span class="fu">mod</span>, lc(<span class="bn">black</span>) ||, <span class="co">/// </span></span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a>  <span class="kw">yline</span>(0) <span class="bn">xtitle</span>(<span class="st">"Model"</span>, <span class="bn">margin</span>(small)) <span class="bn">ytitle</span>(<span class="st">"RD Treatment Effect"</span>, <span class="bn">margin</span>(small)) <span class="co">/// </span></span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a>  <span class="bn">legend</span>(<span class="kw">off</span>) graphregion(<span class="kw">color</span>(<span class="bn">white</span>)) <span class="bn">xscale</span>(<span class="kw">range</span>(0.5 2.5)) <span class="bn">yscale</span>(<span class="kw">range</span>(-0.25 0.05)) <span class="co">/// </span></span>
<span id="cb26-22"><a href="#cb26-22" aria-hidden="true" tabindex="-1"></a>  <span class="kw">ylabel</span>(-0.25(0.05)0.05)</span>
<span id="cb26-23"><a href="#cb26-23" aria-hidden="true" tabindex="-1"></a><span class="kw">qui</span> <span class="kw">graph</span> <span class="kw">export</span> <span class="st">"kernplot.svg"</span>, <span class="kw">replace</span></span>
<span id="cb26-24"><a href="#cb26-24" aria-hidden="true" tabindex="-1"></a><span class="kw">restore</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><img src="kernplot.svg" class="img-fluid" style="width:60.0%"></p>
</div>
</div>
</div>
<p>As with the other model specification tests, the main model is robust. A local linear model with a uniform kernel produces practically the same results as the one with a triangular kernel.</p>
</section>
<section id="test-8-placebo-cutoffs" class="level4">
<h4 class="anchored" data-anchor-id="test-8-placebo-cutoffs">Test 8: Placebo Cutoffs</h4>
<p>Placebo cutoff tests alter the cutoff value of the running variable and re-estimate the treatment effect. As the outcome should only change discontinuously at the true cutoff, placebo cutoffs are expected to yield insignificant estimates. By conducting this test with many placebo cutoffs, researchers obtain an estimate of the false positive rate of the estimation procedure. While rates should be approximately five percent for 95% confidence intervals, they can be substantially higher in RD settings with a large number of observations <span class="citation" data-cites="gelman2019 albada2024comment">(<a href="#ref-gelman2019" role="doc-biblioref">Gelman and Imbens 2019</a>; <a href="#ref-albada2024comment" role="doc-biblioref">Albada 2024a</a>)</span>, raising concerns that a significant estimate at the true cutoff is not actually driven by the treatment.</p>
<p>While the intuition behind placebo cutoff tests is straightforward, they present challenges in modeling decisions. To obtain an accurate estimate of the false positive rate, researchers should ideally mirror the estimation procedure used at the true cutoff. This means staying consistent with observations, polynomial order, kernel, and bandwidth estimation method. However, if one assumes there is a treatment effect, using all observations can lead to contamination, meaning that treated units end up in the control group, and control units in the treatment group.</p>
<p>To mitigate this issue, researchers may decide to only include units with positive values for the running variable when the placebo cutoff is positive, and vice versa. The downside of this separation is that it substantially reduces the number of observations, reducing the probability of estimating statistically significant effects compared to the main model. Furthermore, it complicates bandwidth selection, especially close to the discontinuity. By using a single bandwidth for both sides of the placebo cutoff, researchers can end up with a very small bandwidth, simply because the support of the running variable runs out on one side. Allowing for varying bandwidth sizes solves this problem but takes the placebo cutoff model further from the original estimation procedure.</p>
<p>The other approach assumes there is no treatment effect. In this case, there cannot be any contamination, allowing researchers to conduct placebo cutoff tests with all the observations in the sample. Although this addresses the aforementioned problems, if a treatment effect indeed exists, it renders all contaminated placebo cutoff tests unreliable (i.e.&nbsp;tests that include zero within the bandwidth support).</p>
<p>As there is no clear dominant option between separating observations or using all of them, I present results from both approaches for the sake of completeness. For the placebo cutoff test using all observations, I mimic the main model specification, except for the cutoff point. For the placebo cutoff tests that separate observations, I change both the cutoff point and the bandwidth selection procedure, calculating separate MSE-optimal bandwidths for both sides of the placebo cutoff.</p>
<p>Lastly, one has to decide for which range of running variable values to conduct placebo tests. I stay between the 20th and 80th percentile of the running variable ([-12.8, 19.9]). This should prevent conducting placebo tests with very few observations and stays relatively close to the original estimation procedure.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-11-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-1" role="tab" aria-controls="tabset-11-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-11-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-2" role="tab" aria-controls="tabset-11-2" aria-selected="false">Stata</a></li></ul>
<div class="tab-content">
<div id="tabset-11-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-11-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>cutoff_range <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">13</span>,<span class="dv">20</span>,<span class="fl">0.5</span>) <span class="co"># placebo cutoffs with all observations</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>est <span class="ot">&lt;-</span> <span class="fu">vector</span>()</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>ci_l <span class="ot">&lt;-</span> <span class="fu">vector</span>()</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>ci_r <span class="ot">&lt;-</span> <span class="fu">vector</span>()</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>counter <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (cutoff <span class="cf">in</span> cutoff_range) {</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>  rd <span class="ot">&lt;-</span> <span class="fu">with</span>(df, <span class="fu">rdrobust</span>(inc_party_wonfor1_b1, mv_incparty, <span class="at">c=</span>cutoff))</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>  est[counter] <span class="ot">&lt;-</span> rd<span class="sc">$</span>Estimate[<span class="dv">1</span>]</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>  ci_l[counter] <span class="ot">&lt;-</span> rd<span class="sc">$</span>ci[<span class="dv">3</span>,<span class="dv">1</span>] </span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>  ci_r[counter] <span class="ot">&lt;-</span> rd<span class="sc">$</span>ci[<span class="dv">3</span>,<span class="dv">2</span>]</span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>  counter <span class="ot">&lt;-</span> counter <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>cutoff_all <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(cutoff_range, est, ci_l, ci_r)</span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>cutoff_all <span class="sc">%&lt;&gt;%</span> <span class="fu">mutate</span>(<span class="at">sig=</span><span class="sc">!</span>(ci_l<span class="sc">&lt;</span><span class="dv">0</span><span class="sc">&amp;</span>ci_r<span class="sc">&gt;</span><span class="dv">0</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>cutoff_range <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">13</span>,<span class="sc">-</span><span class="fl">0.5</span>,<span class="fl">0.5</span>) <span class="co"># observations with negative running variable values</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>est <span class="ot">&lt;-</span> <span class="fu">vector</span>()</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>ci_l <span class="ot">&lt;-</span> <span class="fu">vector</span>()</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>ci_r <span class="ot">&lt;-</span> <span class="fu">vector</span>()</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>counter <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (cutoff <span class="cf">in</span> cutoff_range) {</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>  rd <span class="ot">&lt;-</span> <span class="fu">with</span>(df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(mv_incparty<span class="sc">&lt;</span><span class="dv">0</span>), </span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>             <span class="fu">rdrobust</span>(inc_party_wonfor1_b1, mv_incparty, <span class="at">c=</span>cutoff, <span class="at">bwselect=</span><span class="st">"msetwo"</span>))</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>  est[counter] <span class="ot">&lt;-</span> rd<span class="sc">$</span>Estimate[<span class="dv">1</span>]</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>  ci_l[counter] <span class="ot">&lt;-</span> rd<span class="sc">$</span>ci[<span class="dv">3</span>,<span class="dv">1</span>] </span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>  ci_r[counter] <span class="ot">&lt;-</span> rd<span class="sc">$</span>ci[<span class="dv">3</span>,<span class="dv">2</span>]</span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>  counter <span class="ot">&lt;-</span> counter <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>cutoff_n <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(cutoff_range, est, ci_l, ci_r)</span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a>cutoff_n <span class="sc">%&lt;&gt;%</span> <span class="fu">mutate</span>(<span class="at">sig=</span><span class="sc">!</span>(ci_l<span class="sc">&lt;</span><span class="dv">0</span><span class="sc">&amp;</span>ci_r<span class="sc">&gt;</span><span class="dv">0</span>))</span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a>cutoff_range <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">0.5</span>,<span class="dv">20</span>,<span class="fl">0.5</span>) <span class="co"># observations with negative running variable values</span></span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a>est <span class="ot">&lt;-</span> <span class="fu">vector</span>()</span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a>ci_l <span class="ot">&lt;-</span> <span class="fu">vector</span>()</span>
<span id="cb28-22"><a href="#cb28-22" aria-hidden="true" tabindex="-1"></a>ci_r <span class="ot">&lt;-</span> <span class="fu">vector</span>()</span>
<span id="cb28-23"><a href="#cb28-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-24"><a href="#cb28-24" aria-hidden="true" tabindex="-1"></a>counter <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb28-25"><a href="#cb28-25" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (cutoff <span class="cf">in</span> cutoff_range) {</span>
<span id="cb28-26"><a href="#cb28-26" aria-hidden="true" tabindex="-1"></a>  rd <span class="ot">&lt;-</span> <span class="fu">with</span>(df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(mv_incparty<span class="sc">&gt;=</span><span class="dv">0</span>), </span>
<span id="cb28-27"><a href="#cb28-27" aria-hidden="true" tabindex="-1"></a>             <span class="fu">rdrobust</span>(inc_party_wonfor1_b1, mv_incparty, <span class="at">c=</span>cutoff, <span class="at">bwselect=</span><span class="st">"msetwo"</span>))</span>
<span id="cb28-28"><a href="#cb28-28" aria-hidden="true" tabindex="-1"></a>  est[counter] <span class="ot">&lt;-</span> rd<span class="sc">$</span>Estimate[<span class="dv">1</span>]</span>
<span id="cb28-29"><a href="#cb28-29" aria-hidden="true" tabindex="-1"></a>  ci_l[counter] <span class="ot">&lt;-</span> rd<span class="sc">$</span>ci[<span class="dv">3</span>,<span class="dv">1</span>] </span>
<span id="cb28-30"><a href="#cb28-30" aria-hidden="true" tabindex="-1"></a>  ci_r[counter] <span class="ot">&lt;-</span> rd<span class="sc">$</span>ci[<span class="dv">3</span>,<span class="dv">2</span>]</span>
<span id="cb28-31"><a href="#cb28-31" aria-hidden="true" tabindex="-1"></a>  counter <span class="ot">&lt;-</span> counter <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb28-32"><a href="#cb28-32" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb28-33"><a href="#cb28-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-34"><a href="#cb28-34" aria-hidden="true" tabindex="-1"></a>cutoff_p <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(cutoff_range, est, ci_l, ci_r)</span>
<span id="cb28-35"><a href="#cb28-35" aria-hidden="true" tabindex="-1"></a>cutoff_p <span class="sc">%&lt;&gt;%</span> <span class="fu">mutate</span>(<span class="at">sig=</span><span class="sc">!</span>(ci_l<span class="sc">&lt;</span><span class="dv">0</span><span class="sc">&amp;</span>ci_r<span class="sc">&gt;</span><span class="dv">0</span>))</span>
<span id="cb28-36"><a href="#cb28-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-37"><a href="#cb28-37" aria-hidden="true" tabindex="-1"></a>cutoff_separate <span class="ot">&lt;-</span> <span class="fu">rbind</span>(cutoff_n,</span>
<span id="cb28-38"><a href="#cb28-38" aria-hidden="true" tabindex="-1"></a>                         cutoff_all[<span class="dv">27</span>,],</span>
<span id="cb28-39"><a href="#cb28-39" aria-hidden="true" tabindex="-1"></a>                         cutoff_p)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>cutoff_all <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(cutoff_range, est, <span class="at">col=</span>sig)) <span class="sc">+</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">col=</span><span class="st">"grey30"</span>) <span class="sc">+</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin=</span>ci_l, <span class="at">ymax=</span>ci_r)) <span class="sc">+</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"rect"</span>, <span class="at">xmin =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">xmax =</span> <span class="fl">0.5</span>, <span class="at">ymin =</span> <span class="sc">-</span><span class="fl">0.3</span>, <span class="at">ymax =</span> <span class="fl">0.25</span>, <span class="at">alpha =</span> .<span class="dv">15</span>) <span class="sc">+</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>), <span class="at">limits=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.3</span>,<span class="fl">0.25</span>)) <span class="sc">+</span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand=</span><span class="fu">c</span>(<span class="fl">0.02</span>,<span class="fl">0.02</span>), <span class="at">breaks=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">40</span>,<span class="sc">-</span><span class="dv">30</span>,<span class="sc">-</span><span class="dv">20</span>,<span class="sc">-</span><span class="dv">10</span>,<span class="dv">0</span>,<span class="dv">10</span>,<span class="dv">20</span>,<span class="dv">30</span>,<span class="dv">40</span>)) <span class="sc">+</span></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"grey60"</span>, <span class="st">"black"</span>)) <span class="sc">+</span></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"All Observations"</span>,</span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">x=</span><span class="st">"Placebo Cutoff"</span>,</span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">y=</span><span class="st">"Estimated Treatment Effect"</span>) <span class="sc">+</span></span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="rdtesting_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid figure-img" width="648"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>cutoff_separate <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(cutoff_range, est, <span class="at">col=</span>sig)) <span class="sc">+</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">col=</span><span class="st">"grey30"</span>) <span class="sc">+</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin=</span>ci_l, <span class="at">ymax=</span>ci_r)) <span class="sc">+</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"rect"</span>, <span class="at">xmin =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">xmax =</span> <span class="fl">0.5</span>, <span class="at">ymin =</span> <span class="sc">-</span><span class="fl">0.35</span>, <span class="at">ymax =</span> <span class="fl">0.5</span>, <span class="at">alpha =</span> .<span class="dv">15</span>) <span class="sc">+</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>), <span class="at">limits=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.35</span>,<span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand=</span><span class="fu">c</span>(<span class="fl">0.02</span>,<span class="fl">0.02</span>), <span class="at">breaks=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">40</span>,<span class="sc">-</span><span class="dv">30</span>,<span class="sc">-</span><span class="dv">20</span>,<span class="sc">-</span><span class="dv">10</span>,<span class="dv">0</span>,<span class="dv">10</span>,<span class="dv">20</span>,<span class="dv">30</span>,<span class="dv">40</span>)) <span class="sc">+</span></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"grey60"</span>, <span class="st">"black"</span>)) <span class="sc">+</span></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Separated Observations"</span>,</span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">x=</span><span class="st">"Placebo Cutoff"</span>,</span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">y=</span><span class="st">"Estimated Treatment Effect"</span>) <span class="sc">+</span></span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="rdtesting_files/figure-html/unnamed-chunk-27-2.png" class="img-fluid figure-img" width="648"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-11-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-11-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>* <span class="ot">all</span> observations</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="kw">preserve</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>_pctile mv_incparty <span class="kw">if</span> !<span class="fu">missing</span>(inc_party_wonfor1_b1), <span class="kw">p</span>(20, 80)</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a><span class="kw">local</span> c_min = <span class="fu">round</span>(<span class="fu">r</span>(r1),1)</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a><span class="kw">local</span> c_max = <span class="fu">round</span>(<span class="fu">r</span>(r2),1)</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>postutil <span class="kw">clear</span></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a><span class="kw">tempfile</span> results</span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a><span class="kw">postfile</span> <span class="kw">table</span> c <span class="kw">est</span> ci_l ci_r <span class="kw">using</span> <span class="ot">`results'</span></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a><span class="kw">forvalues</span> c=<span class="ot">`c_min'</span>(0.5)<span class="ot">`c_max'</span> {</span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>    <span class="kw">qui</span> rdrobust inc_party_wonfor1_b1 mv_incparty, c(<span class="ot">`c'</span>)</span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>    <span class="kw">post</span> <span class="kw">table</span> (<span class="ot">`c'</span>) (<span class="fu">e</span>(tau_cl)) (<span class="fu">e</span>(ci_l_rb)) (<span class="fu">e</span>(ci_r_rb))</span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a><span class="kw">postclose</span> <span class="kw">table</span></span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a><span class="kw">use</span> <span class="ot">`results'</span>, <span class="kw">clear</span> </span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a><span class="kw">gen</span> sig = !(ci_l&lt;0&amp;ci_r&gt;0)</span>
<span id="cb31-21"><a href="#cb31-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-22"><a href="#cb31-22" aria-hidden="true" tabindex="-1"></a><span class="kw">scatter</span> <span class="kw">est</span> c <span class="kw">if</span> sig==1, mc(<span class="bn">black</span>) || rcap ci_r ci_l c <span class="kw">if</span> sig==1, lc(<span class="bn">black</span>) || <span class="co">/// </span></span>
<span id="cb31-23"><a href="#cb31-23" aria-hidden="true" tabindex="-1"></a>  <span class="kw">scatter</span> <span class="kw">est</span> c <span class="kw">if</span> sig==0, mc(gs10) || rcap ci_r ci_l c <span class="kw">if</span> sig==0, lc(gs10) ||, <span class="co">///</span></span>
<span id="cb31-24"><a href="#cb31-24" aria-hidden="true" tabindex="-1"></a>  <span class="kw">yline</span>(0) <span class="bn">title</span>(<span class="st">"All Observations"</span>) <span class="bn">xtitle</span>(<span class="st">"Placebo Cutoff"</span>, <span class="bn">margin</span>(small)) <span class="co">/// </span></span>
<span id="cb31-25"><a href="#cb31-25" aria-hidden="true" tabindex="-1"></a>  <span class="bn">ytitle</span>(<span class="st">"RD Treatment Effect"</span>, <span class="bn">margin</span>(small)) <span class="bn">legend</span>(<span class="kw">off</span>) graphregion(<span class="kw">color</span>(<span class="bn">white</span>)) <span class="co">/// </span></span>
<span id="cb31-26"><a href="#cb31-26" aria-hidden="true" tabindex="-1"></a>  <span class="bn">xscale</span>(<span class="kw">range</span>(-13 20)) <span class="kw">xlabel</span>(-10(5)20) <span class="bn">yscale</span>(<span class="kw">range</span>(-0.25 0.2)) <span class="kw">ylabel</span>(-0.25(0.05)0.2)</span>
<span id="cb31-27"><a href="#cb31-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-28"><a href="#cb31-28" aria-hidden="true" tabindex="-1"></a><span class="kw">qui</span> <span class="kw">graph</span> <span class="kw">export</span> <span class="st">"cutoffplot_all.svg"</span>, <span class="kw">replace</span></span>
<span id="cb31-29"><a href="#cb31-29" aria-hidden="true" tabindex="-1"></a><span class="kw">restore</span></span>
<span id="cb31-30"><a href="#cb31-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-31"><a href="#cb31-31" aria-hidden="true" tabindex="-1"></a>* separated observations</span>
<span id="cb31-32"><a href="#cb31-32" aria-hidden="true" tabindex="-1"></a><span class="kw">preserve</span></span>
<span id="cb31-33"><a href="#cb31-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-34"><a href="#cb31-34" aria-hidden="true" tabindex="-1"></a>postutil <span class="kw">clear</span></span>
<span id="cb31-35"><a href="#cb31-35" aria-hidden="true" tabindex="-1"></a><span class="kw">tempfile</span> results</span>
<span id="cb31-36"><a href="#cb31-36" aria-hidden="true" tabindex="-1"></a><span class="kw">postfile</span> <span class="kw">table</span> c <span class="kw">est</span> ci_l ci_r <span class="kw">using</span> <span class="ot">`results'</span></span>
<span id="cb31-37"><a href="#cb31-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-38"><a href="#cb31-38" aria-hidden="true" tabindex="-1"></a><span class="kw">forvalues</span> c=<span class="ot">`c_min'</span>(0.5)-0.5 {</span>
<span id="cb31-39"><a href="#cb31-39" aria-hidden="true" tabindex="-1"></a>    <span class="kw">qui</span> rdrobust inc_party_wonfor1_b1 mv_incparty <span class="kw">if</span> mv_incparty&lt;0, c(<span class="ot">`c'</span>) bwselect(msetwo)</span>
<span id="cb31-40"><a href="#cb31-40" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb31-41"><a href="#cb31-41" aria-hidden="true" tabindex="-1"></a>    <span class="kw">post</span> <span class="kw">table</span> (<span class="ot">`c'</span>) (<span class="fu">e</span>(tau_cl)) (<span class="fu">e</span>(ci_l_rb)) (<span class="fu">e</span>(ci_r_rb))</span>
<span id="cb31-42"><a href="#cb31-42" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb31-43"><a href="#cb31-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-44"><a href="#cb31-44" aria-hidden="true" tabindex="-1"></a><span class="kw">qui</span> rdrobust inc_party_wonfor1_b1 mv_incparty</span>
<span id="cb31-45"><a href="#cb31-45" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb31-46"><a href="#cb31-46" aria-hidden="true" tabindex="-1"></a><span class="kw">post</span> <span class="kw">table</span> (0) (<span class="fu">e</span>(tau_cl)) (<span class="fu">e</span>(ci_l_rb)) (<span class="fu">e</span>(ci_r_rb))</span>
<span id="cb31-47"><a href="#cb31-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-48"><a href="#cb31-48" aria-hidden="true" tabindex="-1"></a><span class="kw">forvalues</span> c=0.5(0.5)<span class="ot">`c_max'</span> {</span>
<span id="cb31-49"><a href="#cb31-49" aria-hidden="true" tabindex="-1"></a>    <span class="kw">qui</span> rdrobust inc_party_wonfor1_b1 mv_incparty <span class="kw">if</span> mv_incparty&gt;=0, c(<span class="ot">`c'</span>) bwselect(msetwo)</span>
<span id="cb31-50"><a href="#cb31-50" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb31-51"><a href="#cb31-51" aria-hidden="true" tabindex="-1"></a>    <span class="kw">post</span> <span class="kw">table</span> (<span class="ot">`c'</span>) (<span class="fu">e</span>(tau_cl)) (<span class="fu">e</span>(ci_l_rb)) (<span class="fu">e</span>(ci_r_rb))</span>
<span id="cb31-52"><a href="#cb31-52" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb31-53"><a href="#cb31-53" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb31-54"><a href="#cb31-54" aria-hidden="true" tabindex="-1"></a><span class="kw">postclose</span> <span class="kw">table</span></span>
<span id="cb31-55"><a href="#cb31-55" aria-hidden="true" tabindex="-1"></a><span class="kw">use</span> <span class="ot">`results'</span>, <span class="kw">clear</span> </span>
<span id="cb31-56"><a href="#cb31-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-57"><a href="#cb31-57" aria-hidden="true" tabindex="-1"></a><span class="kw">gen</span> sig = !(ci_l&lt;0&amp;ci_r&gt;0)</span>
<span id="cb31-58"><a href="#cb31-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-59"><a href="#cb31-59" aria-hidden="true" tabindex="-1"></a><span class="kw">scatter</span> <span class="kw">est</span> c <span class="kw">if</span> sig==1, mc(<span class="bn">black</span>) || rcap ci_r ci_l c <span class="kw">if</span> sig==1, lc(<span class="bn">black</span>) || <span class="co">/// </span></span>
<span id="cb31-60"><a href="#cb31-60" aria-hidden="true" tabindex="-1"></a>  <span class="kw">scatter</span> <span class="kw">est</span> c <span class="kw">if</span> sig==0, mc(gs10) || rcap ci_r ci_l c <span class="kw">if</span> sig==0, lc(gs10) ||, <span class="co">/// </span></span>
<span id="cb31-61"><a href="#cb31-61" aria-hidden="true" tabindex="-1"></a>  <span class="kw">yline</span>(0) <span class="bn">title</span>(<span class="st">"Separated Observations"</span>) <span class="bn">xtitle</span>(<span class="st">"Placebo Cutoff"</span>, <span class="bn">margin</span>(small)) <span class="co">/// </span></span>
<span id="cb31-62"><a href="#cb31-62" aria-hidden="true" tabindex="-1"></a>  <span class="bn">ytitle</span>(<span class="st">"RD Treatment Effect"</span>, <span class="bn">margin</span>(small)) <span class="bn">legend</span>(<span class="kw">off</span>) graphregion(<span class="kw">color</span>(<span class="bn">white</span>)) <span class="co">/// </span></span>
<span id="cb31-63"><a href="#cb31-63" aria-hidden="true" tabindex="-1"></a>  <span class="bn">xscale</span>(<span class="kw">range</span>(-13 20)) <span class="kw">xlabel</span>(-10(5)20) <span class="bn">yscale</span>(<span class="kw">range</span>(-0.4 0.5)) <span class="kw">ylabel</span>(-0.4(0.1)0.5)</span>
<span id="cb31-64"><a href="#cb31-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-65"><a href="#cb31-65" aria-hidden="true" tabindex="-1"></a><span class="kw">qui</span> <span class="kw">graph</span> <span class="kw">export</span> <span class="st">"cutoffplot_sep.svg"</span>, <span class="kw">replace</span></span>
<span id="cb31-66"><a href="#cb31-66" aria-hidden="true" tabindex="-1"></a><span class="kw">restore</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><img src="cutoffplot_all.svg" class="img-fluid"> <img src="cutoffplot_sep.svg" class="img-fluid"></p>
</div>
</div>
</div>
<p>The placebo cutoff tests give mixed results. Whereas the approach that seperates observations yields hardly any significant estimates (6% is significant), the approach with all observations yields a substantial number of them (29% is significant).</p>
<p>Nevertheless, with a discontinuity as clear as this one, contamination is a credible explanation. The persistent estimate pattern in the plot with all observations at least suggests so. If significant estimates were driven by overfitting, it would be more likely for the estimates to follow a random pattern, with significant positive estimates directly followed by significant negative ones. The next plot shows that mixing treated and control units can create unusual model fits that should not count as real false positives. At the placebo cutoff of -8, the line on the right side of the placebo cutoff is a combination of treated and control units, which gives a poor fit that cannot be extrapolated outside of the bandwidth.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(df, <span class="fu">rdplot</span>(<span class="at">y=</span>inc_party_wonfor1_b1, <span class="at">x=</span>mv_incparty, <span class="at">p=</span><span class="dv">1</span>, <span class="at">c=</span><span class="sc">-</span><span class="dv">8</span>, <span class="at">kernel =</span> <span class="st">"triangular"</span>, <span class="at">h=</span>rd_l1<span class="sc">$</span>bws[<span class="dv">1</span>],</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">x.lim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">50</span>,<span class="dv">50</span>), <span class="at">col.dots =</span> <span class="st">"grey60"</span>, <span class="at">col.lines =</span> <span class="st">"black"</span>, <span class="at">y.lim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.6</span>),</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">x.label =</span> <span class="st">"Incumbent Party Vote Margin at t"</span>, </span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">y.label =</span> <span class="st">"Probability of Unconditional Victory at t+1"</span>, </span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">title =</span> <span class="st">"Placebo Cutoff at -8"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="rdtesting_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>For these reasons, I would only consider the results from the approach that separates observations. Its false positive rate of 6% is close that the nominal 5% that one would expect using 95% confidence intervals. The placebo cutoff test thus supports the findings from the main model.</p>
</section>
<section id="test-9-statistical-power" class="level4">
<h4 class="anchored" data-anchor-id="test-9-statistical-power">Test 9: Statistical Power</h4>
<p>Calculating statistical power is essential in RD designs since the effective sample size is often much smaller than the full sample due to the bandwidth. In underpowered analyses, the risk that statistically significant effects are false positives is higher. By demonstrating that the analysis has sufficient power, researchers address this concern.</p>
<p>Statistical power is easily calculated with <code>rdpower</code> software. The only requirement is an effect size. Post-hoc power analyses, which use the estimated effect size, are to be avoided. They are simply a different way of writing the p-value, as statistical power and the p-value are directly related. If the p-value is low, statistical power will be high. Ideally, there are external effect sizes available, either from previous studies or based on theoretical predictions. Another option is to use effect size measures. I use the latter: a medium effect size according to Cohen’s <span class="math inline">\(d\)</span>, half the standard deviation of the outcome of control units within the MSE-optimal bandwidth. This corresponds to an effect size of 0.215.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-12-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-1" role="tab" aria-controls="tabset-12-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-12-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-2" role="tab" aria-controls="tabset-12-2" aria-selected="false">Stata</a></li></ul>
<div class="tab-content">
<div id="tabset-12-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-12-1-tab">
<p>Though <code>rdpower</code> has a plot function, customization in R is limited. I therefore plot the power curve myself.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>tau <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">0.5</span><span class="sc">*</span><span class="fu">sd</span>(df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(mv_incparty<span class="sc">&lt;</span><span class="dv">0</span>, mv_incparty<span class="sc">&gt;-</span>rd_l1<span class="sc">$</span>bws[<span class="dv">1</span>]) <span class="sc">%&gt;%</span> </span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">select</span>(inc_party_wonfor1_b1) <span class="sc">%&gt;%</span> <span class="fu">unlist</span>(), <span class="at">na.rm=</span>T)</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>pwr_calc <span class="ot">&lt;-</span> <span class="fu">with</span>(df, <span class="fu">rdpower</span>(<span class="at">data=</span><span class="fu">cbind</span>(inc_party_wonfor1_b1, mv_incparty), <span class="at">tau=</span>tau))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Number of obs =       10010
BW type       =       mserd
Kernel type   =       Triangular
VCE method    =       NN
Derivative    =       0
HA:       tau =       -0.215


Cutoff c = 0          Left of c       Right of c      
Number of obs         4454            5556            
Eff. number of obs    2548            2758            
BW loc. poly.         13.566          13.566          
Order loc. poly.      1               1               
Sampling BW           13.566          13.566          
New sample            2548            2758            


=========================================================================================
Power against:           H0: tau =      0.2*tau =      0.5*tau =      0.8*tau =    tau =          
                         0              -0.043         -0.108         -0.172       -0.215         
-----------------------------------------------------------------------------------------
Robust bias-corrected    0.05           0.329          0.967          1            1              
=========================================================================================</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.new</span>()</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>left <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">0.25</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>right <span class="ot">&lt;-</span> <span class="fl">0.25</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>se <span class="ot">&lt;-</span> pwr_calc<span class="sc">$</span>se.rbc</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>pwr <span class="ot">&lt;-</span> pwr_calc<span class="sc">$</span>power.rbc</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="cf">function</span>(x) <span class="dv">1</span> <span class="sc">-</span> <span class="fu">pnorm</span>((x)<span class="sc">/</span>se <span class="sc">+</span> <span class="fu">qnorm</span>(<span class="dv">1</span> <span class="sc">-</span> alpha<span class="sc">/</span><span class="dv">2</span>)) <span class="sc">+</span> </span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>       <span class="fu">pnorm</span>((x)<span class="sc">/</span>se <span class="sc">-</span> <span class="fu">qnorm</span>(<span class="dv">1</span> <span class="sc">-</span> alpha<span class="sc">/</span><span class="dv">2</span>)), <span class="at">from =</span> left, </span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>     <span class="at">to =</span> right, <span class="at">xlab =</span> <span class="st">""</span>, <span class="at">ylab =</span> <span class="st">""</span>, <span class="at">xlim =</span> <span class="fu">c</span>(left, right))</span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span>pwr, <span class="at">v=</span>tau, <span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="at">main=</span><span class="st">"Power Plot"</span>,</span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">ylab=</span><span class="st">"Power"</span>,</span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a>      <span class="at">xlab=</span><span class="fu">paste</span>(<span class="st">"Treatment Effect</span><span class="sc">\n</span><span class="st">Effect size of"</span>, <span class="fu">round</span>(tau,<span class="dv">2</span>), </span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"yields statistical power of"</span>, <span class="fu">round</span>(<span class="dv">100</span><span class="sc">*</span>pwr,<span class="dv">0</span>), <span class="st">"%"</span> ))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="rdtesting_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-12-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-12-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="kw">qui</span> <span class="kw">sum</span> inc_party_wonfor1_b1 <span class="kw">if</span> mv_incparty&lt;0&amp;mv_incparty&gt;-<span class="fu">e</span>(h_l)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="kw">local</span> tau = -<span class="fu">round</span>(0.5*<span class="fu">r</span>(<span class="fu">sd</span>),0.001)</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a><span class="kw">qui</span> rdpow inc_party_wonfor1_b1 mv_incparty, tau(<span class="ot">`tau'</span>)</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a><span class="kw">local</span> power = <span class="fu">round</span>(100*<span class="fu">r</span>(power_rbc), 1)</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>rdpow inc_party_wonfor1_b1 mv_incparty, tau(<span class="ot">`tau'</span>) plot graph_options(<span class="bn">title</span>(Power Plot) <span class="co">/// </span></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>  <span class="bn">subtitle</span>(Effect <span class="kw">size</span> <span class="kw">of</span> <span class="ot">`tau'</span> yields statistical power <span class="kw">of</span> <span class="ot">`power'</span>%) <span class="bn">ytitle</span>(Power) <span class="co">/// </span></span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>  <span class="bn">xtitle</span>(Treatment Effect) <span class="bn">legend</span>(<span class="kw">off</span>) <span class="bn">xline</span>(<span class="ot">`tau'</span>, lpattern(<span class="kw">dash</span>)))</span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a><span class="kw">qui</span> <span class="kw">graph</span> <span class="kw">export</span> <span class="st">"powerplot.svg"</span>, <span class="kw">replace</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         Cutoff c = 0 | Left of c  Right of c        Number of obs =      10010
----------------------+----------------------        BW type       =      mserd
        Number of obs |      4454        5556        Kernel        = Triangular
   Eff. Number of obs |      2548        2758        VCE method    =         NN
    BW loc. poly. (h) |    13.566      13.566        Derivative    =          0
 Order loc. poly. (p) |         1           1        HA:       tau =     -0.215
----------------------+----------------------
          Sampling BW |    13.566      13.566
           New sample |      2548        2758


Outcome: inc_party_wonfor1_b1. Running variable: mv_incparty.
-------------------------------------------------------------------------------
Power against:        | H0: tau=    0.2*tau =   0.5*tau =   0.8*tau =     tau =
                      |    0.000       -0.043      -0.107      -0.172    -0.215
----------------------+--------------------------------------------------------
Robust bias-corrected |    0.050        0.328       0.966       1.000     1.000
-------------------------------------------------------------------------------</code></pre>
</div>
</div>
<p><img src="powerplot.svg" class="img-fluid" style="width:90.0%"></p>
</div>
</div>
</div>
<p>With a statistical power of 100%, the analysis is clearly sufficiently powered to detect medium effect sizes. In addition, the plot shows that statistical power is acceptable up to effect sizes as small as approximately 0.08, assuming the conventional threshold of 80%. Statistical power should therefore not be a concern in this analysis.</p>
</section>
<section id="test-10-covariates" class="level4">
<h4 class="anchored" data-anchor-id="test-10-covariates">Test 10: Covariates</h4>
<p>Researchers can also alter the model specification by adding relevant pre-treatment covariates to the regression. In theory, this should only improve the efficiency of the estimation and leave point estimates practically unchanged <span class="citation" data-cites="cattaneo2023covariate">(<a href="#ref-cattaneo2023covariate" role="doc-biblioref">Cattaneo, Keele, and Titiunik 2023</a>)</span>. If the estimates do change, this may indicate sorting, reflected in a discontinuity in one or more of the covariates. Alternatively, it could suggest that the default model overfits to noise, as the covariates may have altered the noise pattern. Either way, substantial changes after adding covariates signal the need to further investigate the reliability of the main model.</p>
<p>I add the same covariates as from the balance test, with the exception of the ‘Municipality in Center-East’ dummy - this is to avoid multicolinearity.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-13-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-1" role="tab" aria-controls="tabset-13-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-13-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-2" role="tab" aria-controls="tabset-13-2" aria-selected="false">Stata</a></li></ul>
<div class="tab-content">
<div id="tabset-13-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-13-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>cov <span class="ot">&lt;-</span> <span class="fu">with</span>(df, <span class="fu">rdrobust</span>(inc_party_wonfor1_b1, mv_incparty, </span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>                         <span class="at">covs=</span><span class="fu">cbind</span>(pibpc, population, winner_age, winner_educ, </span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>                                    winner_male, numpar_candidates_eff, dnorte, </span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>                                    dnordeste, dsul, dsudeste, revenue_total, expend_total)))</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>cov_out <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">mod=</span><span class="fu">c</span>(<span class="st">"Main"</span>, <span class="st">"With</span><span class="sc">\n</span><span class="st">Covariates"</span>), </span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>                      <span class="at">est=</span><span class="fu">c</span>(rd_l1<span class="sc">$</span>coef[<span class="dv">1</span>], cov<span class="sc">$</span>coef[<span class="dv">1</span>]), </span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>                      <span class="at">ci_l=</span><span class="fu">c</span>(rd_l1<span class="sc">$</span>ci[<span class="dv">3</span>,<span class="dv">1</span>], cov<span class="sc">$</span>ci[<span class="dv">3</span>,<span class="dv">1</span>]), </span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>                      <span class="at">ci_r=</span><span class="fu">c</span>(rd_l1<span class="sc">$</span>ci[<span class="dv">3</span>,<span class="dv">2</span>], cov<span class="sc">$</span>ci[<span class="dv">3</span>,<span class="dv">2</span>]))</span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>cov_out <span class="sc">%&lt;&gt;%</span> <span class="fu">mutate</span>(<span class="at">sig=</span><span class="sc">!</span>(ci_l<span class="sc">&lt;</span><span class="dv">0</span><span class="sc">&amp;</span>ci_r<span class="sc">&gt;</span><span class="dv">0</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>cov_out <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="fu">factor</span>(mod, <span class="at">level=</span><span class="fu">unique</span>(mod)), est, <span class="at">col=</span><span class="fu">factor</span>(sig, <span class="at">level=</span><span class="fu">c</span>(T, F)))) <span class="sc">+</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">col=</span><span class="st">"grey30"</span>) <span class="sc">+</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin=</span>ci_l, <span class="at">ymax=</span>ci_r)) <span class="sc">+</span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"rect"</span>, <span class="at">xmin =</span> <span class="fl">0.5</span>, <span class="at">xmax =</span> <span class="fl">1.5</span>, <span class="at">ymin =</span> <span class="sc">-</span><span class="fl">0.25</span>, <span class="at">ymax =</span> <span class="fl">0.05</span>, <span class="at">alpha =</span> .<span class="dv">15</span>) <span class="sc">+</span></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>), <span class="at">limits=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.25</span>,<span class="fl">0.05</span>)) <span class="sc">+</span></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">breaks=</span><span class="fu">c</span>(T,F), <span class="at">values=</span><span class="fu">c</span>(<span class="st">"black"</span>, <span class="st">"grey60"</span>)) <span class="sc">+</span></span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Model"</span>,</span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">y=</span><span class="st">"Estimated Treatment Effect"</span>) <span class="sc">+</span></span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="rdtesting_files/figure-html/unnamed-chunk-34-1.png" class="img-fluid figure-img" width="384"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-13-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-13-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="kw">preserve</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>postutil <span class="kw">clear</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a><span class="kw">tempfile</span> results</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a><span class="kw">postfile</span> <span class="kw">table</span> <span class="fu">mod</span> <span class="kw">est</span> ci_l ci_r <span class="kw">using</span> <span class="ot">`results'</span></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a><span class="kw">qui</span> rdrobust inc_party_wonfor1_b1 mv_incparty</span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a><span class="kw">post</span> <span class="kw">table</span> (1) (<span class="fu">e</span>(tau_cl)) (<span class="fu">e</span>(ci_l_rb)) (<span class="fu">e</span>(ci_r_rb))</span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a><span class="kw">qui</span> rdrobust inc_party_wonfor1_b1 mv_incparty, covs(pib population <span class="co">///</span></span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a>numpar_candidates_eff dnorte dsul expend_total revenue_total)</span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a><span class="kw">post</span> <span class="kw">table</span> (2) (<span class="fu">e</span>(tau_cl)) (<span class="fu">e</span>(ci_l_rb)) (<span class="fu">e</span>(ci_r_rb))</span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a><span class="kw">postclose</span> <span class="kw">table</span></span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a><span class="kw">use</span> <span class="ot">`results'</span>, <span class="kw">clear</span> </span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-17"><a href="#cb40-17" aria-hidden="true" tabindex="-1"></a><span class="kw">label</span> def mods 1 <span class="st">"Main"</span> 2 <span class="st">"With Covariates"</span></span>
<span id="cb40-18"><a href="#cb40-18" aria-hidden="true" tabindex="-1"></a><span class="kw">label</span> val <span class="fu">mod</span> mods</span>
<span id="cb40-19"><a href="#cb40-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-20"><a href="#cb40-20" aria-hidden="true" tabindex="-1"></a><span class="kw">scatter</span> <span class="kw">est</span> <span class="fu">mod</span>, mc(<span class="bn">black</span>) <span class="kw">xlabel</span>(1/2, valuelabel) || rcap ci_r ci_l <span class="fu">mod</span>, lc(<span class="bn">black</span>) ||, <span class="co">///</span></span>
<span id="cb40-21"><a href="#cb40-21" aria-hidden="true" tabindex="-1"></a>  <span class="kw">yline</span>(0) <span class="bn">xtitle</span>(<span class="st">"Model"</span>, <span class="bn">margin</span>(small)) <span class="bn">ytitle</span>(<span class="st">"RD Treatment Effect"</span>, <span class="bn">margin</span>(small)) <span class="co">/// </span></span>
<span id="cb40-22"><a href="#cb40-22" aria-hidden="true" tabindex="-1"></a>  <span class="bn">legend</span>(<span class="kw">off</span>) graphregion(<span class="kw">color</span>(<span class="bn">white</span>)) <span class="bn">xscale</span>(<span class="kw">range</span>(0.5 2.5)) <span class="bn">yscale</span>(<span class="kw">range</span>(-0.25 0.05)) <span class="co">/// </span></span>
<span id="cb40-23"><a href="#cb40-23" aria-hidden="true" tabindex="-1"></a>  <span class="kw">ylabel</span>(-0.25(0.05)0.05)</span>
<span id="cb40-24"><a href="#cb40-24" aria-hidden="true" tabindex="-1"></a><span class="kw">qui</span> <span class="kw">graph</span> <span class="kw">export</span> <span class="st">"covplot.svg"</span>, <span class="kw">replace</span></span>
<span id="cb40-25"><a href="#cb40-25" aria-hidden="true" tabindex="-1"></a><span class="kw">restore</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><img src="covplot.svg" class="img-fluid" style="width:60.0%"></p>
</div>
</div>
</div>
<p>Adding covariates does not lead to different inferences. The estimated treatment effect and its accompanying confidence interval stay practically the same. The main models is thus robust to the inclusion of covariates.</p>
</section>
</section>
<section id="summary" class="level3">
<h3 class="anchored" data-anchor-id="summary">Summary</h3>
<p>This replication exercise successfully reproduces and increases confidence in the main result in Table 2 of KT. The density test, balance test, and donut RD give no reason to suspect sorting behavior, supporting the RD identification assumption. Moreover, the various model specification tests yield remarkably stable estimates, demonstrating robustness of the main model. The analysis is well-powered, yields the expected number of false positive findings, and is not sensitive to the inclusion of covariates. By subjecting the main results to such extensive testing, I show that RD designs can meet a high testing standard, and hopefully inspire other researchers to be as thorough in their RD analysis.</p>
</section>
<section id="references" class="level3">




</section>


<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-albada2024comment" class="csl-entry" role="listitem">
Albada, Melle R. 2024a. <span>“Comment on <span>‘Why High-Order Polynomials Should Not Be Used in Regression Discontinuity Designs’</span>.”</span>
</div>
<div id="ref-albada2024overfitting" class="csl-entry" role="listitem">
———. 2024b. <span>“Overfitting in Regression Discontinuity Designs: A Reconsideration of Global and Local Models.”</span>
</div>
<div id="ref-barreca2011" class="csl-entry" role="listitem">
Barreca, Alan I, Melanie Guldi, Jason M Lindo, and Glen R Waddell. 2011. <span>“Saving Babies? Revisiting the Effect of Very Low Birth Weight Classification.”</span> <em>The Quarterly Journal of Economics</em> 126 (4): 2117–23.
</div>
<div id="ref-calonico2015plot" class="csl-entry" role="listitem">
Calonico, Sebastian, Matias D Cattaneo, and Rocio Titiunik. 2015. <span>“Optimal Data-Driven Regression Discontinuity Plots.”</span> <em>Journal of the American Statistical Association</em> 110 (512): 1753–69.
</div>
<div id="ref-cattaneo2020simple" class="csl-entry" role="listitem">
Cattaneo, Matias D, Michael Jansson, and Xinwei Ma. 2020. <span>“Simple Local Polynomial Density Estimators.”</span> <em>Journal of the American Statistical Association</em> 115 (531): 1449–55.
</div>
<div id="ref-cattaneo2023covariate" class="csl-entry" role="listitem">
Cattaneo, Matias D, Luke Keele, and Rocio Titiunik. 2023. <span>“Covariate Adjustment in Regression Discontinuity Designs.”</span> <em>Handbook of Matching and Weighting Adjustments for Causal Inference</em>, 153–68.
</div>
<div id="ref-fitzgerald2024" class="csl-entry" role="listitem">
Fitzgerald, Jack. 2024. <span>“Manipulation Tests in Regression Discontinuity Design: The Need for Equivalence Testing.”</span>
</div>
<div id="ref-gelman2019" class="csl-entry" role="listitem">
Gelman, Andrew, and Guido Imbens. 2019. <span>“Why High-Order Polynomials Should Not Be Used in Regression Discontinuity Designs.”</span> <em>Journal of Business &amp; Economic Statistics</em> 37 (3): 447–56.
</div>
<div id="ref-hartman2021" class="csl-entry" role="listitem">
Hartman, Erin. 2021. <span>“Equivalence Testing for Regression Discontinuity Designs.”</span> <em>Political Analysis</em> 29 (4): 505–21.
</div>
<div id="ref-klasnja2017" class="csl-entry" role="listitem">
Klašnja, Marko, and Rocı́o Titiunik. 2017. <span>“The Incumbency Curse: Weak Parties, Term Limits, and Unfulfilled Accountability.”</span> <em>American Political Science Review</em> 111 (1): 129–48.
</div>
<div id="ref-korting2023" class="csl-entry" role="listitem">
Korting, Christina, Carl Lieberman, Jordan Matsudaira, Zhuan Pei, and Yi Shen. 2023. <span>“Visual Inference and Graphical Representation in Regression Discontinuity Designs.”</span> <em>The Quarterly Journal of Economics</em> 138 (3): 1977–2019.
</div>
<div id="ref-mccrary2008" class="csl-entry" role="listitem">
McCrary, Justin. 2008. <span>“Manipulation of the Running Variable in the Regression Discontinuity Design: A Density Test.”</span> <em>Journal of Econometrics</em> 142 (2): 698–714.
</div>
</div></section><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>Equivalence confidence intervals can be NA due to very small t-statistics (either through a large standard error or a small effect size). In the case of the population variable, it is due to a small effect size, meaning that practically any equivalence test would be statistically significant. The NA confidence interval is therefore no reason for concern. See Hartman <span class="citation" data-cites="hartman2021">(<a href="#ref-hartman2021" role="doc-biblioref">2021</a>)</span>, footnote 19 for a discussion.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>